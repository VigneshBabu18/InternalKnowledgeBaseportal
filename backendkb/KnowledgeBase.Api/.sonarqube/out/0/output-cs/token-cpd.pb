úD
)D:\backendkb\KnowledgeBase.Api\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
AddDbContext 
< 
AppDbContext *
>* +
(+ ,
options, 3
=>4 6
{ 
options 
. 
UseMySql 
( 
builder 
. 
Configuration *
.* +
GetConnectionString+ >
(> ?
$str? H
)H I
,I J
new 
MySqlServerVersion 
( 
new "
Version# *
(* +
$num+ ,
,, -
$num. /
,/ 0
$num1 3
)3 4
)4 5
)5 6
;6 7
} 
) 
; 
var 

jwtSection 
= 
builder 
. 
Configuration &
.& '

GetSection' 1
(1 2
$str2 7
)7 8
;8 9
builder 
. 
Services 
. 
AddSingleton 
( 

jwtSection (
)( )
;) *
builder 
. 
Services 
. 
	AddScoped 
< 
JwtTokenService *
>* +
(+ ,
), -
;- .
builder 
. 
Services 
. 
	AddScoped 
< 
PasswordHasher )
>) *
(* +
)+ ,
;, -
builder 
. 
Services 
. 
AddAuthentication 
( 
opt 
=> 
{ 
opt 
. %
DefaultAuthenticateScheme %
=& '
JwtBearerDefaults( 9
.9 : 
AuthenticationScheme: N
;N O
opt 
. "
DefaultChallengeScheme "
=# $
JwtBearerDefaults% 6
.6 7 
AuthenticationScheme7 K
;K L
} 
) 
. 
AddJwtBearer 
( 
opt 
=> 
{ 
opt 
. %
TokenValidationParameters %
=& '
new( +%
TokenValidationParameters, E
{   	
ValidateIssuer!! 
=!! 
true!! !
,!!! "
ValidateAudience"" 
="" 
true"" #
,""# $
ValidateLifetime## 
=## 
true## #
,### $$
ValidateIssuerSigningKey$$ $
=$$% &
true$$' +
,$$+ ,
ValidIssuer%% 
=%% 

jwtSection%% $
[%%$ %
$str%%% -
]%%- .
,%%. /
ValidAudience&& 
=&& 

jwtSection&& &
[&&& '
$str&&' 1
]&&1 2
,&&2 3
IssuerSigningKey'' 
='' 
new'' " 
SymmetricSecurityKey''# 7
(''7 8
Encoding''8 @
.''@ A
UTF8''A E
.''E F
GetBytes''F N
(''N O

jwtSection''O Y
[''Y Z
$str''Z _
]''_ `
!''` a
)''a b
)''b c
}(( 	
;((	 

})) 
))) 
;)) 
builder++ 
.++ 
Services++ 
.++ 
AddAuthorization++ !
(++! "
options++" )
=>++* ,
{,, 
options-- 
.-- 
	AddPolicy-- 
(-- 
$str-- !
,--! "
policy--# )
=>--* ,
policy--- 3
.--3 4
RequireRole--4 ?
(--? @
$str--@ G
)--G H
)--H I
;--I J
options.. 
... 
	AddPolicy.. 
(.. 
$str.. '
,..' (
policy..) /
=>..0 2
policy..3 9
...9 :
RequireRole..: E
(..E F
$str..F S
)..S T
)..T U
;..U V
options// 
.// 
	AddPolicy// 
(// 
$str//  
,//  !
policy//" (
=>//) +
policy//, 2
.//2 3
RequireRole//3 >
(//> ?
$str//? E
)//E F
)//F G
;//G H
options00 
.00 
	AddPolicy00 
(00 
$str00 *
,00* +
policy00, 2
=>003 5
policy006 <
.00< =
RequireRole00= H
(00H I
$str00I P
,00P Q
$str00R _
)00_ `
)00` a
;00a b
options11 
.11 
	AddPolicy11 
(11 
$str11 (
,11( )
policy11* 0
=>111 3
policy114 :
.11: ;
RequireRole11; F
(11F G
$str11G N
,11N O
$str11P ]
,11] ^
$str11_ e
)11e f
)11f g
;11g h
}22 
)22 
;22 
Console33 
.33 
	WriteLine33 
(33 
BCrypt33 
.33 
Net33 
.33 
BCrypt33 #
.33# $
HashPassword33$ 0
(330 1
$str331 <
)33< =
)33= >
;33> ?
builder66 
.66 
Services66 
.66 
AddCors66 
(66 
options66  
=>66! #
{77 
options88 
.88 
	AddPolicy88 
(88 
$str88 %
,88% &
policy99 
=>99 
{:: 	
policy;; 
.;; 
WithOrigins;; 
(;; 
$str;; 6
);;6 7
.<< 
AllowAnyHeader<< !
(<<! "
)<<" #
.== 
AllowAnyMethod== !
(==! "
)==" #
.>> 
AllowCredentials>> #
(>># $
)>>$ %
;>>% &
}?? 	
)??	 

;??
 
}@@ 
)@@ 
;@@ 
builderBB 
.BB 
ServicesBB 
.BB 
AddControllersBB 
(BB  
)BB  !
;BB! "
builderCC 
.CC 
ServicesCC 
.CC #
AddEndpointsApiExplorerCC (
(CC( )
)CC) *
;CC* +
builderDD 
.DD 
ServicesDD 
.DD 
AddSwaggerGenDD 
(DD 
)DD  
;DD  !
varFF 
appFF 
=FF 	
builderFF
 
.FF 
BuildFF 
(FF 
)FF 
;FF 
usingII 
(II 
varII 

scopeII 
=II 
appII 
.II 
ServicesII 
.II  
CreateScopeII  +
(II+ ,
)II, -
)II- .
{JJ 
varKK 
dbKK 

=KK 
scopeKK 
.KK 
ServiceProviderKK "
.KK" #
GetRequiredServiceKK# 5
<KK5 6
AppDbContextKK6 B
>KKB C
(KKC D
)KKD E
;KKE F
awaitLL 	
dbLL
 
.LL 
DatabaseLL 
.LL 
MigrateAsyncLL "
(LL" #
)LL# $
;LL$ %
awaitMM 	
SeedMM
 
.MM 
RunAsyncMM 
(MM 
dbMM 
)MM 
;MM 
}NN 
ifPP 
(PP 
appPP 
.PP 
EnvironmentPP 
.PP 
IsDevelopmentPP !
(PP! "
)PP" #
)PP# $
{QQ 
appRR 
.RR 

UseSwaggerRR 
(RR 
)RR 
;RR 
appSS 
.SS 
UseSwaggerUISS 
(SS 
)SS 
;SS 
}TT 
appWW 
.WW 
UseCorsWW 
(WW 
$strWW 
)WW 
;WW 
appYY 
.YY 
UseAuthenticationYY 
(YY 
)YY 
;YY 
appZZ 
.ZZ 
UseAuthorizationZZ 
(ZZ 
)ZZ 
;ZZ 
app\\ 
.\\ 
MapControllers\\ 
(\\ 
)\\ 
;\\ 
app^^ 
.^^ 
Run^^ 
(^^ 
)^^ 	
;^^	 

public`` 
partial`` 
class`` 
Program`` 
{`` 
}``  ê
MD:\backendkb\KnowledgeBase.Api\Migrations\20250917163222_UpdatedMigrations.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 

Migrations &
{ 
public 

partial 
class 
UpdatedMigrations *
:+ ,
	Migration- 6
{		 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
	AddColumn &
<& '
string' -
>- .
(. /
name 
: 
$str !
,! "
table 
: 
$str !
,! "
type 
: 
$str  
,  !
nullable 
: 
true 
) 
. 

Annotation 
( 
$str +
,+ ,
$str- 6
)6 7
;7 8
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 

DropColumn '
(' (
name 
: 
$str !
,! "
table 
: 
$str !
)! "
;" #
} 	
} 
} °º
ID:\backendkb\KnowledgeBase.Api\Migrations\20250917071140_InitialCreate.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 

Migrations &
{ 
public

 

partial

 
class

 
InitialCreate

 &
:

' (
	Migration

) 2
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
AlterDatabase *
(* +
)+ ,
. 

Annotation 
( 
$str +
,+ ,
$str- 6
)6 7
;7 8
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str "
," #
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ C
,C D(
MySqlValueGenerationStrategyE a
.a b
IdentityColumnb p
)p q
,q r
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 @
,@ A
nullableB J
:J K
falseL Q
)Q R
. 

Annotation #
(# $
$str$ 3
,3 4
$str5 >
)> ?
,? @
Slug 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 D
,D E
nullableF N
:N O
falseP U
)U V
. 

Annotation #
(# $
$str$ 3
,3 4
$str5 >
)> ?
,? @
Description 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
type7 ;
:; <
$str= G
,G H
nullableI Q
:Q R
trueS W
)W X
. 

Annotation #
(# $
$str$ 3
,3 4
$str5 >
)> ?
} 
, 
constraints 
: 
table "
=># %
{   
table!! 
.!! 

PrimaryKey!! $
(!!$ %
$str!!% 4
,!!4 5
x!!6 7
=>!!8 :
x!!; <
.!!< =
Id!!= ?
)!!? @
;!!@ A
}"" 
)"" 
.## 

Annotation## 
(## 
$str## +
,##+ ,
$str##- 6
)##6 7
;##7 8
migrationBuilder%% 
.%% 
CreateTable%% (
(%%( )
name&& 
:&& 
$str&& 
,&& 
columns'' 
:'' 
table'' 
=>'' !
new''" %
{(( 
Id)) 
=)) 
table)) 
.)) 
Column)) %
<))% &
int))& )
>))) *
())* +
type))+ /
:))/ 0
$str))1 6
,))6 7
nullable))8 @
:))@ A
false))B G
)))G H
.** 

Annotation** #
(**# $
$str**$ C
,**C D(
MySqlValueGenerationStrategy**E a
.**a b
IdentityColumn**b p
)**p q
,**q r

EmployeeId++ 
=++  
table++! &
.++& '
Column++' -
<++- .
string++. 4
>++4 5
(++5 6
type++6 :
:++: ;
$str++< F
,++F G
nullable++H P
:++P Q
true++R V
)++V W
.,, 

Annotation,, #
(,,# $
$str,,$ 3
,,,3 4
$str,,5 >
),,> ?
,,,? @
Name-- 
=-- 
table--  
.--  !
Column--! '
<--' (
string--( .
>--. /
(--/ 0
type--0 4
:--4 5
$str--6 @
,--@ A
nullable--B J
:--J K
false--L Q
)--Q R
... 

Annotation.. #
(..# $
$str..$ 3
,..3 4
$str..5 >
)..> ?
,..? @
Email// 
=// 
table// !
.//! "
Column//" (
<//( )
string//) /
>/// 0
(//0 1
type//1 5
://5 6
$str//7 E
,//E F
nullable//G O
://O P
false//Q V
)//V W
.00 

Annotation00 #
(00# $
$str00$ 3
,003 4
$str005 >
)00> ?
,00? @
PasswordHash11  
=11! "
table11# (
.11( )
Column11) /
<11/ 0
string110 6
>116 7
(117 8
type118 <
:11< =
$str11> H
,11H I
nullable11J R
:11R S
false11T Y
)11Y Z
.22 

Annotation22 #
(22# $
$str22$ 3
,223 4
$str225 >
)22> ?
,22? @
Role33 
=33 
table33  
.33  !
Column33! '
<33' (
int33( +
>33+ ,
(33, -
type33- 1
:331 2
$str333 8
,338 9
nullable33: B
:33B C
false33D I
)33I J
,33J K
IsActive44 
=44 
table44 $
.44$ %
Column44% +
<44+ ,
bool44, 0
>440 1
(441 2
type442 6
:446 7
$str448 @
,44@ A
nullable44B J
:44J K
false44L Q
)44Q R
,44R S
	CreatedAt55 
=55 
table55  %
.55% &
Column55& ,
<55, -
DateTime55- 5
>555 6
(556 7
type557 ;
:55; <
$str55= J
,55J K
nullable55L T
:55T U
false55V [
)55[ \
,55\ ]
	UpdatedAt66 
=66 
table66  %
.66% &
Column66& ,
<66, -
DateTime66- 5
>665 6
(666 7
type667 ;
:66; <
$str66= J
,66J K
nullable66L T
:66T U
true66V Z
)66Z [
}77 
,77 
constraints88 
:88 
table88 "
=>88# %
{99 
table:: 
.:: 

PrimaryKey:: $
(::$ %
$str::% /
,::/ 0
x::1 2
=>::3 5
x::6 7
.::7 8
Id::8 :
)::: ;
;::; <
};; 
);; 
.<< 

Annotation<< 
(<< 
$str<< +
,<<+ ,
$str<<- 6
)<<6 7
;<<7 8
migrationBuilder>> 
.>> 
CreateTable>> (
(>>( )
name?? 
:?? 
$str??  
,??  !
columns@@ 
:@@ 
table@@ 
=>@@ !
new@@" %
{AA 
IdBB 
=BB 
tableBB 
.BB 
ColumnBB %
<BB% &
intBB& )
>BB) *
(BB* +
typeBB+ /
:BB/ 0
$strBB1 6
,BB6 7
nullableBB8 @
:BB@ A
falseBBB G
)BBG H
.CC 

AnnotationCC #
(CC# $
$strCC$ C
,CCC D(
MySqlValueGenerationStrategyCCE a
.CCa b
IdentityColumnCCb p
)CCp q
,CCq r
NameDD 
=DD 
tableDD  
.DD  !
ColumnDD! '
<DD' (
stringDD( .
>DD. /
(DD/ 0
typeDD0 4
:DD4 5
$strDD6 @
,DD@ A
nullableDDB J
:DDJ K
falseDDL Q
)DDQ R
.EE 

AnnotationEE #
(EE# $
$strEE$ 3
,EE3 4
$strEE5 >
)EE> ?
,EE? @
DescriptionFF 
=FF  !
tableFF" '
.FF' (
ColumnFF( .
<FF. /
stringFF/ 5
>FF5 6
(FF6 7
typeFF7 ;
:FF; <
$strFF= G
,FFG H
nullableFFI Q
:FFQ R
falseFFS X
)FFX Y
.GG 

AnnotationGG #
(GG# $
$strGG$ 3
,GG3 4
$strGG5 >
)GG> ?
,GG? @
ContentHH 
=HH 
tableHH #
.HH# $
ColumnHH$ *
<HH* +
stringHH+ 1
>HH1 2
(HH2 3
typeHH3 7
:HH7 8
$strHH9 C
,HHC D
nullableHHE M
:HHM N
trueHHO S
)HHS T
.II 

AnnotationII #
(II# $
$strII$ 3
,II3 4
$strII5 >
)II> ?
,II? @

CategoryIdJJ 
=JJ  
tableJJ! &
.JJ& '
ColumnJJ' -
<JJ- .
intJJ. 1
>JJ1 2
(JJ2 3
typeJJ3 7
:JJ7 8
$strJJ9 >
,JJ> ?
nullableJJ@ H
:JJH I
falseJJJ O
)JJO P
,JJP Q
AuthorIdKK 
=KK 
tableKK $
.KK$ %
ColumnKK% +
<KK+ ,
intKK, /
>KK/ 0
(KK0 1
typeKK1 5
:KK5 6
$strKK7 <
,KK< =
nullableKK> F
:KKF G
falseKKH M
)KKM N
,KKN O
StatusLL 
=LL 
tableLL "
.LL" #
ColumnLL# )
<LL) *
intLL* -
>LL- .
(LL. /
typeLL/ 3
:LL3 4
$strLL5 :
,LL: ;
nullableLL< D
:LLD E
falseLLF K
)LLK L
,LLL M
RejectReasonMM  
=MM! "
tableMM# (
.MM( )
ColumnMM) /
<MM/ 0
stringMM0 6
>MM6 7
(MM7 8
typeMM8 <
:MM< =
$strMM> H
,MMH I
nullableMMJ R
:MMR S
trueMMT X
)MMX Y
.NN 

AnnotationNN #
(NN# $
$strNN$ 3
,NN3 4
$strNN5 >
)NN> ?
,NN? @

ApprovedAtOO 
=OO  
tableOO! &
.OO& '
ColumnOO' -
<OO- .
DateTimeOO. 6
>OO6 7
(OO7 8
typeOO8 <
:OO< =
$strOO> K
,OOK L
nullableOOM U
:OOU V
trueOOW [
)OO[ \
,OO\ ]
	ViewCountPP 
=PP 
tablePP  %
.PP% &
ColumnPP& ,
<PP, -
longPP- 1
>PP1 2
(PP2 3
typePP3 7
:PP7 8
$strPP9 A
,PPA B
nullablePPC K
:PPK L
falsePPM R
)PPR S
,PPS T
	CreatedAtQQ 
=QQ 
tableQQ  %
.QQ% &
ColumnQQ& ,
<QQ, -
DateTimeQQ- 5
>QQ5 6
(QQ6 7
typeQQ7 ;
:QQ; <
$strQQ= J
,QQJ K
nullableQQL T
:QQT U
falseQQV [
)QQ[ \
,QQ\ ]
	UpdatedAtRR 
=RR 
tableRR  %
.RR% &
ColumnRR& ,
<RR, -
DateTimeRR- 5
>RR5 6
(RR6 7
typeRR7 ;
:RR; <
$strRR= J
,RRJ K
nullableRRL T
:RRT U
trueRRV Z
)RRZ [
}SS 
,SS 
constraintsTT 
:TT 
tableTT "
=>TT# %
{UU 
tableVV 
.VV 

PrimaryKeyVV $
(VV$ %
$strVV% 2
,VV2 3
xVV4 5
=>VV6 8
xVV9 :
.VV: ;
IdVV; =
)VV= >
;VV> ?
tableWW 
.WW 

ForeignKeyWW $
(WW$ %
nameXX 
:XX 
$strXX A
,XXA B
columnYY 
:YY 
xYY  !
=>YY" $
xYY% &
.YY& '

CategoryIdYY' 1
,YY1 2
principalTableZZ &
:ZZ& '
$strZZ( 4
,ZZ4 5
principalColumn[[ '
:[[' (
$str[[) -
,[[- .
onDelete\\  
:\\  !
ReferentialAction\\" 3
.\\3 4
Restrict\\4 <
)\\< =
;\\= >
table]] 
.]] 

ForeignKey]] $
(]]$ %
name^^ 
:^^ 
$str^^ :
,^^: ;
column__ 
:__ 
x__  !
=>__" $
x__% &
.__& '
AuthorId__' /
,__/ 0
principalTable`` &
:``& '
$str``( /
,``/ 0
principalColumnaa '
:aa' (
$straa) -
,aa- .
onDeletebb  
:bb  !
ReferentialActionbb" 3
.bb3 4
Cascadebb4 ;
)bb; <
;bb< =
}cc 
)cc 
.dd 

Annotationdd 
(dd 
$strdd +
,dd+ ,
$strdd- 6
)dd6 7
;dd7 8
migrationBuilderff 
.ff 
CreateTableff (
(ff( )
namegg 
:gg 
$strgg $
,gg$ %
columnshh 
:hh 
tablehh 
=>hh !
newhh" %
{ii 
Idjj 
=jj 
tablejj 
.jj 
Columnjj %
<jj% &
longjj& *
>jj* +
(jj+ ,
typejj, 0
:jj0 1
$strjj2 :
,jj: ;
nullablejj< D
:jjD E
falsejjF K
)jjK L
.kk 

Annotationkk #
(kk# $
$strkk$ C
,kkC D(
MySqlValueGenerationStrategykkE a
.kka b
IdentityColumnkkb p
)kkp q
,kkq r
	ArticleIdll 
=ll 
tablell  %
.ll% &
Columnll& ,
<ll, -
intll- 0
>ll0 1
(ll1 2
typell2 6
:ll6 7
$strll8 =
,ll= >
nullablell? G
:llG H
falsellI N
)llN O
,llO P
UserIdmm 
=mm 
tablemm "
.mm" #
Columnmm# )
<mm) *
intmm* -
>mm- .
(mm. /
typemm/ 3
:mm3 4
$strmm5 :
,mm: ;
nullablemm< D
:mmD E
truemmF J
)mmJ K
,mmK L
ViewedAtnn 
=nn 
tablenn $
.nn$ %
Columnnn% +
<nn+ ,
DateTimenn, 4
>nn4 5
(nn5 6
typenn6 :
:nn: ;
$strnn< I
,nnI J
nullablennK S
:nnS T
falsennU Z
)nnZ [
}oo 
,oo 
constraintspp 
:pp 
tablepp "
=>pp# %
{qq 
tablerr 
.rr 

PrimaryKeyrr $
(rr$ %
$strrr% 6
,rr6 7
xrr8 9
=>rr: <
xrr= >
.rr> ?
Idrr? A
)rrA B
;rrB C
tabless 
.ss 

ForeignKeyss $
(ss$ %
namett 
:tt 
$strtt B
,ttB C
columnuu 
:uu 
xuu  !
=>uu" $
xuu% &
.uu& '
	ArticleIduu' 0
,uu0 1
principalTablevv &
:vv& '
$strvv( 2
,vv2 3
principalColumnww '
:ww' (
$strww) -
,ww- .
onDeletexx  
:xx  !
ReferentialActionxx" 3
.xx3 4
Cascadexx4 ;
)xx; <
;xx< =
}yy 
)yy 
.zz 

Annotationzz 
(zz 
$strzz +
,zz+ ,
$strzz- 6
)zz6 7
;zz7 8
migrationBuilder|| 
.|| 
CreateTable|| (
(||( )
name}} 
:}} 
$str}}  
,}}  !
columns~~ 
:~~ 
table~~ 
=>~~ !
new~~" %
{ 
Id
ÄÄ 
=
ÄÄ 
table
ÄÄ 
.
ÄÄ 
Column
ÄÄ %
<
ÄÄ% &
int
ÄÄ& )
>
ÄÄ) *
(
ÄÄ* +
type
ÄÄ+ /
:
ÄÄ/ 0
$str
ÄÄ1 6
,
ÄÄ6 7
nullable
ÄÄ8 @
:
ÄÄ@ A
false
ÄÄB G
)
ÄÄG H
.
ÅÅ 

Annotation
ÅÅ #
(
ÅÅ# $
$str
ÅÅ$ C
,
ÅÅC D*
MySqlValueGenerationStrategy
ÅÅE a
.
ÅÅa b
IdentityColumn
ÅÅb p
)
ÅÅp q
,
ÅÅq r
	ArticleId
ÇÇ 
=
ÇÇ 
table
ÇÇ  %
.
ÇÇ% &
Column
ÇÇ& ,
<
ÇÇ, -
int
ÇÇ- 0
>
ÇÇ0 1
(
ÇÇ1 2
type
ÇÇ2 6
:
ÇÇ6 7
$str
ÇÇ8 =
,
ÇÇ= >
nullable
ÇÇ? G
:
ÇÇG H
false
ÇÇI N
)
ÇÇN O
,
ÇÇO P
UserId
ÉÉ 
=
ÉÉ 
table
ÉÉ "
.
ÉÉ" #
Column
ÉÉ# )
<
ÉÉ) *
int
ÉÉ* -
>
ÉÉ- .
(
ÉÉ. /
type
ÉÉ/ 3
:
ÉÉ3 4
$str
ÉÉ5 :
,
ÉÉ: ;
nullable
ÉÉ< D
:
ÉÉD E
false
ÉÉF K
)
ÉÉK L
,
ÉÉL M
Text
ÑÑ 
=
ÑÑ 
table
ÑÑ  
.
ÑÑ  !
Column
ÑÑ! '
<
ÑÑ' (
string
ÑÑ( .
>
ÑÑ. /
(
ÑÑ/ 0
type
ÑÑ0 4
:
ÑÑ4 5
$str
ÑÑ6 @
,
ÑÑ@ A
nullable
ÑÑB J
:
ÑÑJ K
false
ÑÑL Q
)
ÑÑQ R
.
ÖÖ 

Annotation
ÖÖ #
(
ÖÖ# $
$str
ÖÖ$ 3
,
ÖÖ3 4
$str
ÖÖ5 >
)
ÖÖ> ?
,
ÖÖ? @
	CreatedAt
ÜÜ 
=
ÜÜ 
table
ÜÜ  %
.
ÜÜ% &
Column
ÜÜ& ,
<
ÜÜ, -
DateTime
ÜÜ- 5
>
ÜÜ5 6
(
ÜÜ6 7
type
ÜÜ7 ;
:
ÜÜ; <
$str
ÜÜ= J
,
ÜÜJ K
nullable
ÜÜL T
:
ÜÜT U
false
ÜÜV [
)
ÜÜ[ \
}
áá 
,
áá 
constraints
àà 
:
àà 
table
àà "
=>
àà# %
{
ââ 
table
ää 
.
ää 

PrimaryKey
ää $
(
ää$ %
$str
ää% 2
,
ää2 3
x
ää4 5
=>
ää6 8
x
ää9 :
.
ää: ;
Id
ää; =
)
ää= >
;
ää> ?
table
ãã 
.
ãã 

ForeignKey
ãã $
(
ãã$ %
name
åå 
:
åå 
$str
åå >
,
åå> ?
column
çç 
:
çç 
x
çç  !
=>
çç" $
x
çç% &
.
çç& '
	ArticleId
çç' 0
,
çç0 1
principalTable
éé &
:
éé& '
$str
éé( 2
,
éé2 3
principalColumn
èè '
:
èè' (
$str
èè) -
,
èè- .
onDelete
êê  
:
êê  !
ReferentialAction
êê" 3
.
êê3 4
Cascade
êê4 ;
)
êê; <
;
êê< =
table
ëë 
.
ëë 

ForeignKey
ëë $
(
ëë$ %
name
íí 
:
íí 
$str
íí 8
,
íí8 9
column
ìì 
:
ìì 
x
ìì  !
=>
ìì" $
x
ìì% &
.
ìì& '
UserId
ìì' -
,
ìì- .
principalTable
îî &
:
îî& '
$str
îî( /
,
îî/ 0
principalColumn
ïï '
:
ïï' (
$str
ïï) -
,
ïï- .
onDelete
ññ  
:
ññ  !
ReferentialAction
ññ" 3
.
ññ3 4
Cascade
ññ4 ;
)
ññ; <
;
ññ< =
}
óó 
)
óó 
.
òò 

Annotation
òò 
(
òò 
$str
òò +
,
òò+ ,
$str
òò- 6
)
òò6 7
;
òò7 8
migrationBuilder
öö 
.
öö 
CreateIndex
öö (
(
öö( )
name
õõ 
:
õõ 
$str
õõ ,
,
õõ, -
table
úú 
:
úú 
$str
úú !
,
úú! "
column
ùù 
:
ùù 
$str
ùù "
)
ùù" #
;
ùù# $
migrationBuilder
üü 
.
üü 
CreateIndex
üü (
(
üü( )
name
†† 
:
†† 
$str
†† .
,
††. /
table
°° 
:
°° 
$str
°° !
,
°°! "
column
¢¢ 
:
¢¢ 
$str
¢¢ $
)
¢¢$ %
;
¢¢% &
migrationBuilder
§§ 
.
§§ 
CreateIndex
§§ (
(
§§( )
name
•• 
:
•• 
$str
•• 1
,
••1 2
table
¶¶ 
:
¶¶ 
$str
¶¶ %
,
¶¶% &
column
ßß 
:
ßß 
$str
ßß #
)
ßß# $
;
ßß$ %
migrationBuilder
©© 
.
©© 
CreateIndex
©© (
(
©©( )
name
™™ 
:
™™ 
$str
™™ *
,
™™* +
table
´´ 
:
´´ 
$str
´´ #
,
´´# $
column
¨¨ 
:
¨¨ 
$str
¨¨ 
,
¨¨ 
unique
≠≠ 
:
≠≠ 
true
≠≠ 
)
≠≠ 
;
≠≠ 
migrationBuilder
ØØ 
.
ØØ 
CreateIndex
ØØ (
(
ØØ( )
name
∞∞ 
:
∞∞ 
$str
∞∞ -
,
∞∞- .
table
±± 
:
±± 
$str
±± !
,
±±! "
column
≤≤ 
:
≤≤ 
$str
≤≤ #
)
≤≤# $
;
≤≤$ %
migrationBuilder
¥¥ 
.
¥¥ 
CreateIndex
¥¥ (
(
¥¥( )
name
µµ 
:
µµ 
$str
µµ *
,
µµ* +
table
∂∂ 
:
∂∂ 
$str
∂∂ !
,
∂∂! "
column
∑∑ 
:
∑∑ 
$str
∑∑  
)
∑∑  !
;
∑∑! "
migrationBuilder
ππ 
.
ππ 
CreateIndex
ππ (
(
ππ( )
name
∫∫ 
:
∫∫ 
$str
∫∫ &
,
∫∫& '
table
ªª 
:
ªª 
$str
ªª 
,
ªª 
column
ºº 
:
ºº 
$str
ºº 
,
ºº  
unique
ΩΩ 
:
ΩΩ 
true
ΩΩ 
)
ΩΩ 
;
ΩΩ 
}
ææ 	
	protected
¡¡ 
override
¡¡ 
void
¡¡ 
Down
¡¡  $
(
¡¡$ %
MigrationBuilder
¡¡% 5
migrationBuilder
¡¡6 F
)
¡¡F G
{
¬¬ 	
migrationBuilder
√√ 
.
√√ 
	DropTable
√√ &
(
√√& '
name
ƒƒ 
:
ƒƒ 
$str
ƒƒ $
)
ƒƒ$ %
;
ƒƒ% &
migrationBuilder
∆∆ 
.
∆∆ 
	DropTable
∆∆ &
(
∆∆& '
name
«« 
:
«« 
$str
««  
)
««  !
;
««! "
migrationBuilder
…… 
.
…… 
	DropTable
…… &
(
……& '
name
   
:
   
$str
    
)
    !
;
  ! "
migrationBuilder
ÃÃ 
.
ÃÃ 
	DropTable
ÃÃ &
(
ÃÃ& '
name
ÕÕ 
:
ÕÕ 
$str
ÕÕ "
)
ÕÕ" #
;
ÕÕ# $
migrationBuilder
œœ 
.
œœ 
	DropTable
œœ &
(
œœ& '
name
–– 
:
–– 
$str
–– 
)
–– 
;
–– 
}
—— 	
}
““ 
}”” Ÿ
.D:\backendkb\KnowledgeBase.Api\Dto\UserDtos.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
DTOs  
;  !
public 
class 
CreateUserRequest 
{ 
public 

string 

EmployeeId 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
default- 4
!4 5
;5 6
public		 

string		 
Name		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
=		% &
default		' .
!		. /
;		/ 0
public

 

string

 
Email

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
=

& '
default

( /
!

/ 0
;

0 1
public 

string 
Password 
{ 
get  
;  !
set" %
;% &
}' (
=) *
default+ 2
!2 3
;3 4
public 

Role 
Role 
{ 
get 
; 
set 
;  
}! "
} 
public 
class 
UpdateUserRequest 
{ 
public 

string 

EmployeeId 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
default- 4
!4 5
;5 6
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

string 
Email 
{ 
get 
; 
set "
;" #
}$ %
=& '
default( /
!/ 0
;0 1
public 

Role 
Role 
{ 
get 
; 
set 
;  
}! "
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 
Password 
{ 
get !
;! "
set# &
;& '
}( )
} 
public 
class 
UserSummary 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 

EmployeeId 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
default- 4
!4 5
;5 6
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public   

string   
Email   
{   
get   
;   
set   "
;  " #
}  $ %
=  & '
default  ( /
!  / 0
;  0 1
public!! 

string!! 
Role!! 
{!! 
get!! 
;!! 
set!! !
;!!! "
}!!# $
=!!% &
default!!' .
!!!. /
;!!/ 0
public"" 

bool"" 
IsActive"" 
{"" 
get"" 
;"" 
set""  #
;""# $
}""% &
}## ˇ
1D:\backendkb\KnowledgeBase.Api\Dto\CommentDtos.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
DTOs  
;  !
public 
class  
CreateCommentRequest !
{ 
public 

int 
	ArticleId 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
Text 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
} 
public		 
class		 
CommentResponse		 
{

 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

int 
	ArticleId 
{ 
get 
; 
set  #
;# $
}% &
public 

int 
UserId 
{ 
get 
; 
set  
;  !
}" #
public 

string 
UserName 
{ 
get  
;  !
set" %
;% &
}' (
=) *
default+ 2
!2 3
;3 4
public 

string 
Text 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
} ƒ
2D:\backendkb\KnowledgeBase.Api\Dto\CategoryDtos.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
DTOs  
;  !
public 
class 
CategoryRequest 
{ 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

string 
Slug 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
public

 
class

 
CategoryResponse

 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

string 
Slug 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
} ¨
.D:\backendkb\KnowledgeBase.Api\Dto\AuthDtos.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
DTOs  
;  !
public 
class 
LoginRequest 
{ 
public 

string 
Email 
{ 
get 
; 
set "
;" #
}$ %
=& '
default( /
!/ 0
;0 1
public 

string 
Password 
{ 
get  
;  !
set" %
;% &
}' (
=) *
default+ 2
!2 3
;3 4
} 
public		 
class		 
LoginResponse		 
{

 
public 

string 
Token 
{ 
get 
; 
set "
;" #
}$ %
=& '
default( /
!/ 0
;0 1
public 

string 
Role 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

int 
? 
UserId 
{ 
get 
; 
set !
;! "
}# $
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

string 
Email 
{ 
get 
; 
set "
;" #
}$ %
=& '
default( /
!/ 0
;0 1
} ‡$
1D:\backendkb\KnowledgeBase.Api\Dto\ArticleDtos.cs
public 
class  
CreateArticleRequest !
{ 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

string 
Description 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
default. 5
!5 6
;6 7
public 

string 
? 
Content 
{ 
get  
;  !
set" %
;% &
}' (
public 

int 

CategoryId 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
? 
	DriveLink 
{ 
get "
;" #
set$ '
;' (
}) *
} 
public

 
class

  
UpdateArticleRequest

 !
{ 
public 

string 
? 
Name 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
Content 
{ 
get  
;  !
set" %
;% &
}' (
public 

int 
? 

CategoryId 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
? 
	DriveLink 
{ 
get "
;" #
set$ '
;' (
}) *
} 
public 
class 
ArticleResponse 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

string 
Description 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
default. 5
!5 6
;6 7
public 

string 
? 
Content 
{ 
get  
;  !
set" %
;% &
}' (
public 

int 

CategoryId 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
CategoryName 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
default/ 6
!6 7
;7 8
public 

int 
AuthorId 
{ 
get 
; 
set "
;" #
}$ %
public 

string 

AuthorName 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
default- 4
!4 5
;5 6
public 

string 
Status 
{ 
get 
; 
set  #
;# $
}% &
=' (
default) 0
!0 1
;1 2
public 

string 
? 
RejectReason 
{  !
get" %
;% &
set' *
;* +
}, -
public 

DateTime 
? 

ApprovedAt 
{  !
get" %
;% &
set' *
;* +
}, -
public   

long   
	ViewCount   
{   
get   
;    
set  ! $
;  $ %
}  & '
public!! 

string!! 
?!! 
	DriveLink!! 
{!! 
get!! "
;!!" #
set!!$ '
;!!' (
}!!) *
public"" 

DateTime"" 
	CreatedAt"" 
{"" 
get""  #
;""# $
set""% (
;""( )
}""* +
}## Ë
3D:\backendkb\KnowledgeBase.Api\Domain\Enums\Role.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
Domain "
." #
Enums# (
;( )
public 
enum 
Role 
{ 
Admin 	
=
 
$num 
, 
Contributor 
= 
$num 
, 
User 
=	 

$num 
} ˝
<D:\backendkb\KnowledgeBase.Api\Domain\Enums\ArticleStatus.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
Domain "
." #
Enums# (
;( )
public 
enum 
ArticleStatus 
{ 
Pending 
= 
$num 
, 
Approved 
= 
$num 
, 
Rejected 
= 
$num 
} ê
6D:\backendkb\KnowledgeBase.Api\Domain\Entities\User.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
Domain "
." #
Entities# +
;+ ,
public 
class 
User 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 
? 

EmployeeId 
{ 
get  #
;# $
set% (
;( )
}* +
public		 

string		 
Name		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
=		% &
default		' .
!		. /
;		/ 0
public

 

string

 
Email

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
=

& '
default

( /
!

/ 0
;

0 1
public 

string 
PasswordHash 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
default/ 6
!6 7
;7 8
public 

Role 
Role 
{ 
get 
; 
set 
;  
}! "
=# $
Role% )
.) *
User* .
;. /
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
=' (
true) -
;- .
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
DateTime. 6
.6 7
UtcNow7 =
;= >
public 

DateTime 
? 
	UpdatedAt 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

List 
< 
Article 
> 
Articles !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
new2 5
(5 6
)6 7
;7 8
public 

List 
< 
Comment 
> 
Comments !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
new2 5
(5 6
)6 7
;7 8
} Ä
9D:\backendkb\KnowledgeBase.Api\Domain\Entities\Comment.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
Domain "
." #
Entities# +
;+ ,
public 
class 
Comment 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

int 
	ArticleId 
{ 
get 
; 
set  #
;# $
}% &
public 

Article 
Article 
{ 
get  
;  !
set" %
;% &
}' (
=) *
default+ 2
!2 3
;3 4
public 

int 
UserId 
{ 
get 
; 
set  
;  !
}" #
public		 

User		 
User		 
{		 
get		 
;		 
set		 
;		  
}		! "
=		# $
default		% ,
!		, -
;		- .
public

 

string

 
Text

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
=

% &
default

' .
!

. /
;

/ 0
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
DateTime. 6
.6 7
UtcNow7 =
;= >
} «

:D:\backendkb\KnowledgeBase.Api\Domain\Entities\Category.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
Domain "
." #
Entities# +
;+ ,
public 
class 
Category 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

string 
Slug 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
public

 

List

 
<

 
Article

 
>

 
Articles

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
=

0 1
new

2 5
(

5 6
)

6 7
;

7 8
} Â	
=D:\backendkb\KnowledgeBase.Api\Domain\Entities\ArticleView.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
Domain "
." #
Entities# +
;+ ,
public 
class 
ArticleView 
{ 
public 

long 
Id 
{ 
get 
; 
set 
; 
}  
public 

int 
	ArticleId 
{ 
get 
; 
set  #
;# $
}% &
public 

Article 
Article 
{ 
get  
;  !
set" %
;% &
}' (
=) *
default+ 2
!2 3
;3 4
public 

int 
? 
UserId 
{ 
get 
; 
set !
;! "
}# $
public		 

DateTime		 
ViewedAt		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
=		+ ,
DateTime		- 5
.		5 6
UtcNow		6 <
;		< =
}

 °
9D:\backendkb\KnowledgeBase.Api\Domain\Entities\Article.cs
public 
class 
Article 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

string 
Description 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
default. 5
!5 6
;6 7
public		 

string		 
?		 
Content		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 

int

 

CategoryId

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 

Category 
Category 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
default- 4
!4 5
;5 6
public 

int 
AuthorId 
{ 
get 
; 
set "
;" #
}$ %
public 

User 
Author 
{ 
get 
; 
set !
;! "
}# $
=% &
default' .
!. /
;/ 0
public 

ArticleStatus 
Status 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
ArticleStatus0 =
.= >
Pending> E
;E F
public 

string 
? 
RejectReason 
{  !
get" %
;% &
set' *
;* +
}, -
public 

DateTime 
? 

ApprovedAt 
{  !
get" %
;% &
set' *
;* +
}, -
public 

long 
	ViewCount 
{ 
get 
;  
set! $
;$ %
}& '
=( )
$num* +
;+ ,
public 

string 
? 
	DriveLink 
{ 
get "
;" #
set$ '
;' (
}) *
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
DateTime. 6
.6 7
UtcNow7 =
;= >
public 

DateTime 
? 
	UpdatedAt 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

List 
< 
Comment 
> 
Comments !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
new2 5
(5 6
)6 7
;7 8
public 

List 
< 
ArticleView 
> 
Views "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
new3 6
(6 7
)7 8
;8 9
} 
+D:\backendkb\KnowledgeBase.Api\Data\Seed.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
Data  
;  !
public 
static 
class 
Seed 
{ 
public 

static 
async 
Task 
RunAsync %
(% &
AppDbContext& 2
db3 5
)5 6
{		 
if

 

(

 
!

 
await

 
db

 
.

 

Categories

  
.

  !
AnyAsync

! )
(

) *
)

* +
)

+ ,
{ 	
db 
. 

Categories 
. 
AddRange "
(" #
new 
Category 
{ 
Name #
=$ %
$str& *
,* +
Slug, 0
=1 2
$str3 7
,7 8
Description9 D
=E F
$strG X
}Y Z
,Z [
new 
Category 
{ 
Name #
=$ %
$str& *
,* +
Slug, 0
=1 2
$str3 7
,7 8
Description9 D
=E F
$strG _
}` a
,a b
new 
Category 
{ 
Name #
=$ %
$str& 3
,3 4
Slug5 9
=: ;
$str< A
,A B
DescriptionC N
=O P
$strQ n
}o p
) 
; 
} 	
await 
db 
. 
SaveChangesAsync !
(! "
)" #
;# $
} 
} ¬3
3D:\backendkb\KnowledgeBase.Api\Data\AppDbContext.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
Data  
;  !
public 
class 
AppDbContext 
: 
	DbContext %
{ 
public 

AppDbContext 
( 
DbContextOptions (
<( )
AppDbContext) 5
>5 6
options7 >
)> ?
:@ A
baseB F
(F G
optionsG N
)N O
{P Q
}R S
public

 

DbSet

 
<

 
User

 
>

 
Users

 
=>

 
Set

  #
<

# $
User

$ (
>

( )
(

) *
)

* +
;

+ ,
public 

DbSet 
< 
Category 
> 

Categories %
=>& (
Set) ,
<, -
Category- 5
>5 6
(6 7
)7 8
;8 9
public 

DbSet 
< 
Article 
> 
Articles "
=># %
Set& )
<) *
Article* 1
>1 2
(2 3
)3 4
;4 5
public 

DbSet 
< 
Comment 
> 
Comments "
=># %
Set& )
<) *
Comment* 1
>1 2
(2 3
)3 4
;4 5
public 

DbSet 
< 
ArticleView 
> 
ArticleViews *
=>+ -
Set. 1
<1 2
ArticleView2 =
>= >
(> ?
)? @
;@ A
	protected 
override 
void 
OnModelCreating +
(+ ,
ModelBuilder, 8
modelBuilder9 E
)E F
{ 
base 
. 
OnModelCreating 
( 
modelBuilder )
)) *
;* +
modelBuilder 
. 
Entity 
< 
User  
>  !
(! "
)" #
. 
HasIndex 
( 
u 
=> 
u 
. 
Email "
)" #
. 
IsUnique 
( 
) 
; 
modelBuilder 
. 
Entity 
< 
Category $
>$ %
(% &
)& '
. 
HasIndex 
( 
c 
=> 
c 
. 
Slug !
)! "
. 
IsUnique 
( 
) 
; 
modelBuilder 
. 
Entity 
< 
Article #
># $
($ %
)% &
. 
HasOne 
( 
a 
=> 
a 
. 
Category #
)# $
. 
WithMany 
( 
c 
=> 
c 
. 
Articles %
)% &
. 
HasForeignKey 
( 
a 
=> 
a  !
.! "

CategoryId" ,
), -
.   
OnDelete   
(   
DeleteBehavior   $
.  $ %
Restrict  % -
)  - .
;  . /
modelBuilder"" 
."" 
Entity"" 
<"" 
Article"" #
>""# $
(""$ %
)""% &
.## 
HasOne## 
(## 
a## 
=>## 
a## 
.## 
Author## !
)##! "
.$$ 
WithMany$$ 
($$ 
u$$ 
=>$$ 
u$$ 
.$$ 
Articles$$ %
)$$% &
.%% 
HasForeignKey%% 
(%% 
a%% 
=>%% 
a%%  !
.%%! "
AuthorId%%" *
)%%* +
.&& 
OnDelete&& 
(&& 
DeleteBehavior&& $
.&&$ %
Cascade&&% ,
)&&, -
;&&- .
modelBuilder(( 
.(( 
Entity(( 
<(( 
Comment(( #
>((# $
((($ %
)((% &
.)) 
HasOne)) 
()) 
c)) 
=>)) 
c)) 
.)) 
Article)) "
)))" #
.** 
WithMany** 
(** 
a** 
=>** 
a** 
.** 
Comments** %
)**% &
.++ 
HasForeignKey++ 
(++ 
c++ 
=>++ 
c++  !
.++! "
	ArticleId++" +
)+++ ,
.,, 
OnDelete,, 
(,, 
DeleteBehavior,, $
.,,$ %
Cascade,,% ,
),,, -
;,,- .
modelBuilder.. 
... 
Entity.. 
<.. 
Comment.. #
>..# $
(..$ %
)..% &
.// 
HasOne// 
(// 
c// 
=>// 
c// 
.// 
User// 
)//  
.00 
WithMany00 
(00 
u00 
=>00 
u00 
.00 
Comments00 %
)00% &
.11 
HasForeignKey11 
(11 
c11 
=>11 
c11  !
.11! "
UserId11" (
)11( )
.22 
OnDelete22 
(22 
DeleteBehavior22 $
.22$ %
Cascade22% ,
)22, -
;22- .
modelBuilder44 
.44 
Entity44 
<44 
ArticleView44 '
>44' (
(44( )
)44) *
.55 
HasOne55 
(55 
v55 
=>55 
v55 
.55 
Article55 "
)55" #
.66 
WithMany66 
(66 
a66 
=>66 
a66 
.66 
Views66 "
)66" #
.77 
HasForeignKey77 
(77 
v77 
=>77 
v77  !
.77! "
	ArticleId77" +
)77+ ,
.88 
OnDelete88 
(88 
DeleteBehavior88 $
.88$ %
Cascade88% ,
)88, -
;88- .
}99 
}:: ﬁ\
>D:\backendkb\KnowledgeBase.Api\Controller\ProfileController.cs
	namespace		 	
KnowledgeBase		
 
.		 
Api		 
.		 
Controllers		 '
;		' (
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
[ 
	Authorize 

(
 
Policy 
= 
$str &
)& '
]' (
public 
class 
ProfileController 
:  
ControllerBase! /
{ 
private 
readonly 
AppDbContext !
_db" %
;% &
private 
readonly 
PasswordHasher #
_hasher$ +
;+ ,
public 

ProfileController 
( 
AppDbContext )
db* ,
,, -
PasswordHasher. <
hasher= C
)C D
{ 
_db 
= 
db 
; 
_hasher 
= 
hasher 
; 
} 
int 
CurrentUserId 
=> 
int 
. 
Parse "
(" #
User# '
.' (
FindFirstValue( 6
(6 7

ClaimTypes7 A
.A B
NameIdentifierB P
)P Q
!Q R
)R S
;S T
[ 
HttpGet 
] 
public 

async 
Task 
< 
ActionResult "
<" #
UserSummary# .
>. /
>/ 0
Get1 4
(4 5
)5 6
{ 
var 
user 
= 
await 
_db 
. 
Users "
." #
FirstOrDefaultAsync# 6
(6 7
u7 8
=>9 ;
u< =
.= >
Id> @
==A C
CurrentUserIdD Q
)Q R
;R S
if   

(   
user   
==   
null   
)   
return    
NotFound  ! )
(  ) *
$str  * [
)  [ \
;  \ ]
return"" 
Ok"" 
("" 
new"" 
UserSummary"" !
{## 	
Id$$ 
=$$ 
user$$ 
.$$ 
Id$$ 
,$$ 

EmployeeId%% 
=%% 
user%% 
.%% 

EmployeeId%% (
??%%) +
$str%%, .
,%%. /
Name&& 
=&& 
user&& 
.&& 
Name&& 
,&& 
Email'' 
='' 
user'' 
.'' 
Email'' 
,'' 
Role(( 
=(( 
user(( 
.(( 
Role(( 
.(( 
ToString(( %
(((% &
)((& '
,((' (
IsActive)) 
=)) 
user)) 
.)) 
IsActive)) $
}** 	
)**	 

;**
 
}++ 
[.. 
HttpPut.. 
].. 
public// 

async// 
Task// 
<// 
IActionResult// #
>//# $
Update//% +
(//+ ,
[//, -
FromBody//- 5
]//5 6
UpdateUserRequest//7 H
req//I L
)//L M
{00 
var11 
user11 
=11 
await11 
_db11 
.11 
Users11 "
.11" #
FirstOrDefaultAsync11# 6
(116 7
u117 8
=>119 ;
u11< =
.11= >
Id11> @
==11A C
CurrentUserId11D Q
)11Q R
;11R S
if22 

(22 
user22 
==22 
null22 
)22 
return22  
NotFound22! )
(22) *
$str22* >
)22> ?
;22? @
if44 

(44 
!44 
string44 
.44 
IsNullOrWhiteSpace44 &
(44& '
req44' *
.44* +
Name44+ /
)44/ 0
)440 1
user55 
.55 
Name55 
=55 
req55 
.55 
Name55  
;55  !
if77 

(77 
!77 
string77 
.77 
IsNullOrWhiteSpace77 &
(77& '
req77' *
.77* +
Password77+ 3
)773 4
)774 5
user88 
.88 
PasswordHash88 
=88 
_hasher88  '
.88' (
Hash88( ,
(88, -
req88- 0
.880 1
Password881 9
)889 :
;88: ;
user:: 
.:: 
	UpdatedAt:: 
=:: 
DateTime:: !
.::! "
UtcNow::" (
;::( )
await;; 
_db;; 
.;; 
SaveChangesAsync;; "
(;;" #
);;# $
;;;$ %
return<< 
	NoContent<< 
(<< 
)<< 
;<< 
}== 
[@@ 
HttpGet@@ 
(@@ 
$str@@ 
)@@ 
]@@ 
publicAA 

asyncAA 
TaskAA 
<AA 
ActionResultAA "
<AA" #
objectAA# )
>AA) *
>AA* +
	DashboardAA, 5
(AA5 6
)AA6 7
{BB 
ifCC 

(CC 
UserCC 
.CC 
IsInRoleCC 
(CC 
$strCC '
)CC' (
)CC( )
{DD 	
varEE 
myIdEE 
=EE 
CurrentUserIdEE $
;EE$ %
varFF 
	totalMineFF 
=FF 
awaitFF !
_dbFF" %
.FF% &
ArticlesFF& .
.FF. /

CountAsyncFF/ 9
(FF9 :
aFF: ;
=>FF< >
aFF? @
.FF@ A
AuthorIdFFA I
==FFJ L
myIdFFM Q
)FFQ R
;FFR S
varGG 
pendingGG 
=GG 
awaitGG 
_dbGG  #
.GG# $
ArticlesGG$ ,
.GG, -

CountAsyncGG- 7
(GG7 8
aGG8 9
=>GG: <
aGG= >
.GG> ?
AuthorIdGG? G
==GGH J
myIdGGK O
&&GGP R
aGGS T
.GGT U
StatusGGU [
==GG\ ^
DomainGG_ e
.GGe f
EnumsGGf k
.GGk l
ArticleStatusGGl y
.GGy z
Pending	GGz Å
)
GGÅ Ç
;
GGÇ É
varHH 
approvedHH 
=HH 
awaitHH  
_dbHH! $
.HH$ %
ArticlesHH% -
.HH- .

CountAsyncHH. 8
(HH8 9
aHH9 :
=>HH; =
aHH> ?
.HH? @
AuthorIdHH@ H
==HHI K
myIdHHL P
&&HHQ S
aHHT U
.HHU V
StatusHHV \
==HH] _
DomainHH` f
.HHf g
EnumsHHg l
.HHl m
ArticleStatusHHm z
.HHz {
Approved	HH{ É
)
HHÉ Ñ
;
HHÑ Ö
varII 
rejectedII 
=II 
awaitII  
_dbII! $
.II$ %
ArticlesII% -
.II- .

CountAsyncII. 8
(II8 9
aII9 :
=>II; =
aII> ?
.II? @
AuthorIdII@ H
==III K
myIdIIL P
&&IIQ S
aIIT U
.IIU V
StatusIIV \
==II] _
DomainII` f
.IIf g
EnumsIIg l
.IIl m
ArticleStatusIIm z
.IIz {
Rejected	II{ É
)
IIÉ Ñ
;
IIÑ Ö
varKK 
topMineKK 
=KK 
awaitKK 
_dbKK  #
.KK# $
ArticlesKK$ ,
.LL 
WhereLL 
(LL 
aLL 
=>LL 
aLL 
.LL 
AuthorIdLL &
==LL' )
myIdLL* .
)LL. /
.MM 
OrderByDescendingMM "
(MM" #
aMM# $
=>MM% '
aMM( )
.MM) *
	ViewCountMM* 3
)MM3 4
.NN 
TakeNN 
(NN 
$numNN 
)NN 
.OO 
SelectOO 
(OO 
aOO 
=>OO 
newOO  
{OO! "
aOO# $
.OO$ %
IdOO% '
,OO' (
aOO) *
.OO* +
NameOO+ /
,OO/ 0
aOO1 2
.OO2 3
	ViewCountOO3 <
,OO< =
statusOO> D
=OOE F
aOOG H
.OOH I
StatusOOI O
.OOO P
ToStringOOP X
(OOX Y
)OOY Z
}OO[ \
)OO\ ]
.PP 
ToListAsyncPP 
(PP 
)PP 
;PP 
returnRR 
OkRR 
(RR 
newRR 
{SS 
totalArticlesTT 
=TT 
	totalMineTT  )
,TT) *
pendingUU 
,UU 
approvedVV 
,VV 
rejectedWW 
,WW 
topViewedMineXX 
=XX 
topMineXX  '
}YY 
)YY 
;YY 
}ZZ 	
else[[ 
{\\ 	
var^^ 
recent^^ 
=^^ 
await^^ 
_db^^ "
.^^" #
Articles^^# +
.__ 
Where__ 
(__ 
a__ 
=>__ 
a__ 
.__ 
Status__ $
==__% '
Domain__( .
.__. /
Enums__/ 4
.__4 5
ArticleStatus__5 B
.__B C
Approved__C K
)__K L
.`` 
OrderByDescending`` "
(``" #
a``# $
=>``% '
a``( )
.``) *

ApprovedAt``* 4
)``4 5
.aa 
Takeaa 
(aa 
$numaa 
)aa 
.bb 
Selectbb 
(bb 
abb 
=>bb 
newbb  
{bb! "
abb# $
.bb$ %
Idbb% '
,bb' (
abb) *
.bb* +
Namebb+ /
,bb/ 0
abb1 2
.bb2 3

CategoryIdbb3 =
,bb= >
abb? @
.bb@ A
	ViewCountbbA J
}bbK L
)bbL M
.cc 
ToListAsynccc 
(cc 
)cc 
;cc 
varee 
topee 
=ee 
awaitee 
_dbee 
.ee  
Articlesee  (
.ff 
Whereff 
(ff 
aff 
=>ff 
aff 
.ff 
Statusff $
==ff% '
Domainff( .
.ff. /
Enumsff/ 4
.ff4 5
ArticleStatusff5 B
.ffB C
ApprovedffC K
)ffK L
.gg 
OrderByDescendinggg "
(gg" #
agg# $
=>gg% '
agg( )
.gg) *
	ViewCountgg* 3
)gg3 4
.hh 
Takehh 
(hh 
$numhh 
)hh 
.ii 
Selectii 
(ii 
aii 
=>ii 
newii  
{ii! "
aii# $
.ii$ %
Idii% '
,ii' (
aii) *
.ii* +
Nameii+ /
,ii/ 0
aii1 2
.ii2 3

CategoryIdii3 =
,ii= >
aii? @
.ii@ A
	ViewCountiiA J
}iiK L
)iiL M
.jj 
ToListAsyncjj 
(jj 
)jj 
;jj 
returnll 
Okll 
(ll 
newll 
{mm 
recentApprovednn 
=nn  
recentnn! '
,nn' (

mostViewedoo 
=oo 
topoo  
}pp 
)pp 
;pp 
}qq 	
}rr 
}ss ƒ5
?D:\backendkb\KnowledgeBase.Api\Controller\CommentsController.cs
	namespace		 	
KnowledgeBase		
 
.		 
Api		 
.		 
Controllers		 '
;		' (
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
[ 
	Authorize 

(
 
Policy 
= 
$str &
)& '
]' (
public 
class 
CommentsController 
:  !
ControllerBase" 0
{ 
private 
readonly 
AppDbContext !
_db" %
;% &
public 

CommentsController 
( 
AppDbContext *
db+ -
)- .
=>/ 1
_db2 5
=6 7
db8 :
;: ;
int 
CurrentUserId 
=> 
int 
. 
Parse "
(" #
User# '
.' (
FindFirstValue( 6
(6 7

ClaimTypes7 A
.A B
NameIdentifierB P
)P Q
!Q R
)R S
;S T
[ 
HttpPost 
] 
public 

async 
Task 
< 
ActionResult "
<" #
CommentResponse# 2
>2 3
>3 4
Create5 ;
(; <
[< =
FromBody= E
]E F 
CreateCommentRequestG [
req\ _
)_ `
{ 
var 
article 
= 
await 
_db 
.  
Articles  (
.( )
FirstOrDefaultAsync) <
(< =
a= >
=>? A
aB C
.C D
IdD F
==G I
reqJ M
.M N
	ArticleIdN W
)W X
;X Y
if 

( 
article 
== 
null 
) 
return #
NotFound$ ,
(, -
$str- A
)A B
;B C
if 

( 
article 
. 
Status 
!= 
ArticleStatus +
.+ ,
Approved, 4
)4 5
return 

BadRequest 
( 
$str G
)G H
;H I
var 
user 
= 
await 
_db 
. 
Users "
." #
	FindAsync# ,
(, -
CurrentUserId- :
): ;
;; <
var 
c 
= 
new 
Domain 
. 
Entities #
.# $
Comment$ +
{ 	
	ArticleId   
=   
req   
.   
	ArticleId   %
,  % &
UserId!! 
=!! 
CurrentUserId!! "
,!!" #
Text"" 
="" 
req"" 
."" 
Text"" 
}## 	
;##	 

_db$$ 
.$$ 
Comments$$ 
.$$ 
Add$$ 
($$ 
c$$ 
)$$ 
;$$ 
await%% 
_db%% 
.%% 
SaveChangesAsync%% "
(%%" #
)%%# $
;%%$ %
return'' 
Ok'' 
('' 
new'' 
CommentResponse'' %
{(( 	
Id)) 
=)) 
c)) 
.)) 
Id)) 
,)) 
	ArticleId** 
=** 
c** 
.** 
	ArticleId** #
,**# $
UserId++ 
=++ 
c++ 
.++ 
UserId++ 
,++ 
UserName,, 
=,, 
user,, 
?,, 
.,, 
Name,, !
??,," $
$str,,% +
,,,+ ,
Text-- 
=-- 
c-- 
.-- 
Text-- 
,-- 
	CreatedAt.. 
=.. 
c.. 
... 
	CreatedAt.. #
}// 	
)//	 

;//
 
}00 
[33 
HttpGet33 
(33 
$str33 &
)33& '
]33' (
public44 

async44 
Task44 
<44 
ActionResult44 "
<44" #
IEnumerable44# .
<44. /
CommentResponse44/ >
>44> ?
>44? @
>44@ A

ForArticle44B L
(44L M
int44M P
	articleId44Q Z
)44Z [
{55 
var66 
articleExists66 
=66 
await66 !
_db66" %
.66% &
Articles66& .
.66. /
AnyAsync66/ 7
(667 8
a668 9
=>66: <
a66= >
.66> ?
Id66? A
==66B D
	articleId66E N
)66N O
;66O P
if77 

(77 
!77 
articleExists77 
)77 
return77 "
NotFound77# +
(77+ ,
$str77, @
)77@ A
;77A B
var99 
list99 
=99 
await99 
_db99 
.99 
Comments99 %
.:: 
Include:: 
(:: 
c:: 
=>:: 
c:: 
.:: 
User::  
)::  !
.;; 
Where;; 
(;; 
c;; 
=>;; 
c;; 
.;; 
	ArticleId;; #
==;;$ &
	articleId;;' 0
);;0 1
.<< 
OrderByDescending<< 
(<< 
c<<  
=><<! #
c<<$ %
.<<% &
	CreatedAt<<& /
)<</ 0
.== 
Select== 
(== 
c== 
=>== 
new== 
CommentResponse== ,
{>> 
Id?? 
=?? 
c?? 
.?? 
Id?? 
,?? 
	ArticleId@@ 
=@@ 
c@@ 
.@@ 
	ArticleId@@ '
,@@' (
UserIdAA 
=AA 
cAA 
.AA 
UserIdAA !
,AA! "
UserNameBB 
=BB 
cBB 
.BB 
UserBB !
.BB! "
NameBB" &
,BB& '
TextCC 
=CC 
cCC 
.CC 
TextCC 
,CC 
	CreatedAtDD 
=DD 
cDD 
.DD 
	CreatedAtDD '
}EE 
)EE 
.FF 
ToListAsyncFF 
(FF 
)FF 
;FF 
returnHH 
OkHH 
(HH 
listHH 
)HH 
;HH 
}II 
}JJ õZ
;D:\backendkb\KnowledgeBase.Api\Controller\AuthController.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
Controllers '
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
AuthController 
:  !
ControllerBase" 0
{ 
private 
readonly 
AppDbContext %
_db& )
;) *
private 
readonly 
JwtTokenService (
_jwt) -
;- .
private 
readonly 
PasswordHasher '
_hasher( /
;/ 0
private 
readonly 
IConfiguration '
_config( /
;/ 0
public 
AuthController 
( 
AppDbContext *
db+ -
,- .
JwtTokenService/ >
jwt? B
,B C
PasswordHasherD R
hasherS Y
,Y Z
IConfiguration[ i
configj p
)p q
{ 	
_db 
= 
db 
; 
_jwt 
= 
jwt 
; 
_hasher 
= 
hasher 
; 
_config 
= 
config 
; 
} 	
[   	
HttpPost  	 
(   
$str   
)   
]   
[!! 	
AllowAnonymous!!	 
]!! 
public"" 
async"" 
Task"" 
<"" 
ActionResult"" &
<""& '
LoginResponse""' 4
>""4 5
>""5 6
Login""7 <
(""< =
[""= >
FromBody""> F
]""F G
LoginRequest""H T
req""U X
)""X Y
{## 	
try$$ 
{%% 
if'' 
('' 
string'' 
.'' 
IsNullOrWhiteSpace'' -
(''- .
req''. 1
.''1 2
Email''2 7
)''7 8
||''9 ;
string''< B
.''B C
IsNullOrWhiteSpace''C U
(''U V
req''V Y
.''Y Z
Password''Z b
)''b c
)''c d
return(( 

BadRequest(( %
(((% &
new((& )
{((* +
message((, 3
=((4 5
$str((6 W
}((X Y
)((Y Z
;((Z [
var++ 

adminEmail++ 
=++  
_config++! (
[++( )
$str++) A
]++A B
;++B C
var,, 
	adminPass,, 
=,, 
_config,,  '
[,,' (
$str,,( C
],,C D
;,,D E
if-- 
(-- 
req-- 
.-- 
Email-- 
.-- 
Equals-- $
(--$ %

adminEmail--% /
,--/ 0
StringComparison--1 A
.--A B
OrdinalIgnoreCase--B S
)--S T
&&--U W
req--X [
.--[ \
Password--\ d
==--e g
	adminPass--h q
)--q r
{.. 
var// 
admin// 
=// 
new//  #
User//$ (
{00 
Id11 
=11 
$num11 
,11 
Name22 
=22 
$str22 .
,22. /
Email33 
=33 

adminEmail33  *
!33* +
,33+ ,
Role44 
=44 
Role44 #
.44# $
Admin44$ )
}55 
;55 
var66 
token66 
=66 
_jwt66  $
.66$ %
Create66% +
(66+ ,
admin66, 1
)661 2
;662 3
return77 
Ok77 
(77 
new77 !
LoginResponse77" /
{88 
Token99 
=99 
token99  %
,99% &
Role:: 
=:: 
Role:: #
.::# $
Admin::$ )
.::) *
ToString::* 2
(::2 3
)::3 4
,::4 5
UserId;; 
=;;  
null;;! %
,;;% &
Name<< 
=<< 
admin<< $
.<<$ %
Name<<% )
,<<) *
Email== 
=== 
admin==  %
.==% &
Email==& +
}>> 
)>> 
;>> 
}?? 
varBB 
userBB 
=BB 
awaitBB  
_dbBB! $
.BB$ %
UsersBB% *
.BB* +
FirstOrDefaultAsyncBB+ >
(BB> ?
uBB? @
=>BBA C
uBBD E
.BBE F
EmailBBF K
==BBL N
reqBBO R
.BBR S
EmailBBS X
&&BBY [
uBB\ ]
.BB] ^
IsActiveBB^ f
)BBf g
;BBg h
ifCC 
(CC 
userCC 
==CC 
nullCC  
)CC  !
returnDD 
UnauthorizedDD '
(DD' (
newDD( +
{DD, -
messageDD. 5
=DD6 7
$strDD8 S
}DDT U
)DDU V
;DDV W
ifGG 
(GG 
!GG 
_hasherGG 
.GG 
VerifyGG #
(GG# $
reqGG$ '
.GG' (
PasswordGG( 0
,GG0 1
userGG2 6
.GG6 7
PasswordHashGG7 C
)GGC D
)GGD E
returnHH 
UnauthorizedHH '
(HH' (
newHH( +
{HH, -
messageHH. 5
=HH6 7
$strHH8 S
}HHT U
)HHU V
;HHV W
varKK 
jwtKK 
=KK 
_jwtKK 
.KK 
CreateKK %
(KK% &
userKK& *
)KK* +
;KK+ ,
returnLL 
OkLL 
(LL 
newLL 
LoginResponseLL +
{MM 
TokenNN 
=NN 
jwtNN 
,NN  
RoleOO 
=OO 
userOO 
.OO  
RoleOO  $
.OO$ %
ToStringOO% -
(OO- .
)OO. /
,OO/ 0
UserIdPP 
=PP 
userPP !
.PP! "
IdPP" $
,PP$ %
NameQQ 
=QQ 
userQQ 
.QQ  
NameQQ  $
,QQ$ %
EmailRR 
=RR 
userRR  
.RR  !
EmailRR! &
}SS 
)SS 
;SS 
}TT 
catchUU 
(UU 
	ExceptionUU 
exUU 
)UU  
{VV 
returnXX 

StatusCodeXX !
(XX! "
$numXX" %
,XX% &
newXX' *
{XX+ ,
messageXX- 4
=XX5 6
$strXX7 W
}XXX Y
)XXY Z
;XXZ [
}YY 
}ZZ 	
[]] 	
HttpPost]]	 
(]] 
$str]] %
)]]% &
]]]& '
[^^ 	
	Authorize^^	 
(^^ 
Policy^^ 
=^^ 
$str^^ '
)^^' (
]^^( )
public__ 
async__ 
Task__ 
<__ 
ActionResult__ &
<__& '
UserSummary__' 2
>__2 3
>__3 4

CreateUser__5 ?
(__? @
[__@ A
FromBody__A I
]__I J
CreateUserRequest__K \
req__] `
)__` a
{`` 	
tryaa 
{bb 
ifdd 
(dd 
stringdd 
.dd 
IsNullOrWhiteSpacedd -
(dd- .
reqdd. 1
.dd1 2
Emaildd2 7
)dd7 8
||dd9 ;
stringee 
.ee 
IsNullOrWhiteSpaceee -
(ee- .
reqee. 1
.ee1 2
Passwordee2 :
)ee: ;
||ee< >
stringff 
.ff 
IsNullOrWhiteSpaceff -
(ff- .
reqff. 1
.ff1 2
Nameff2 6
)ff6 7
)ff7 8
{gg 
returnhh 

BadRequesthh %
(hh% &
newhh& )
{hh* +
messagehh, 3
=hh4 5
$strhh6 ^
}hh_ `
)hh` a
;hha b
}ii 
ifkk 
(kk 
reqkk 
.kk 
Rolekk 
==kk 
Rolekk  $
.kk$ %
Adminkk% *
)kk* +
returnll 

BadRequestll %
(ll% &
newll& )
{ll* +
messagell, 3
=ll4 5
$strll6 T
}llU V
)llV W
;llW X
ifnn 
(nn 
awaitnn 
_dbnn 
.nn 
Usersnn #
.nn# $
AnyAsyncnn$ ,
(nn, -
xnn- .
=>nn/ 1
xnn2 3
.nn3 4
Emailnn4 9
==nn: <
reqnn= @
.nn@ A
EmailnnA F
)nnF G
)nnG H
returnoo 
Conflictoo #
(oo# $
newoo$ '
{oo( )
messageoo* 1
=oo2 3
$stroo4 K
}ooL M
)ooM N
;ooN O
varqq 
userqq 
=qq 
newqq 
Userqq #
{rr 

EmployeeIdss 
=ss  
reqss! $
.ss$ %

EmployeeIdss% /
,ss/ 0
Namett 
=tt 
reqtt 
.tt 
Namett #
,tt# $
Emailuu 
=uu 
requu 
.uu  
Emailuu  %
,uu% &
PasswordHashvv  
=vv! "
_hashervv# *
.vv* +
Hashvv+ /
(vv/ 0
reqvv0 3
.vv3 4
Passwordvv4 <
)vv< =
,vv= >
Roleww 
=ww 
reqww 
.ww 
Roleww #
,ww# $
IsActivexx 
=xx 
truexx #
}yy 
;yy 
_db{{ 
.{{ 
Users{{ 
.{{ 
Add{{ 
({{ 
user{{ "
){{" #
;{{# $
await|| 
_db|| 
.|| 
SaveChangesAsync|| *
(||* +
)||+ ,
;||, -
return~~ 
Ok~~ 
(~~ 
new~~ 
UserSummary~~ )
{ 
Id
ÄÄ 
=
ÄÄ 
user
ÄÄ 
.
ÄÄ 
Id
ÄÄ  
,
ÄÄ  !

EmployeeId
ÅÅ 
=
ÅÅ  
user
ÅÅ! %
.
ÅÅ% &

EmployeeId
ÅÅ& 0
!
ÅÅ0 1
,
ÅÅ1 2
Name
ÇÇ 
=
ÇÇ 
user
ÇÇ 
.
ÇÇ  
Name
ÇÇ  $
,
ÇÇ$ %
Email
ÉÉ 
=
ÉÉ 
user
ÉÉ  
.
ÉÉ  !
Email
ÉÉ! &
,
ÉÉ& '
Role
ÑÑ 
=
ÑÑ 
user
ÑÑ 
.
ÑÑ  
Role
ÑÑ  $
.
ÑÑ$ %
ToString
ÑÑ% -
(
ÑÑ- .
)
ÑÑ. /
,
ÑÑ/ 0
IsActive
ÖÖ 
=
ÖÖ 
user
ÖÖ #
.
ÖÖ# $
IsActive
ÖÖ$ ,
}
ÜÜ 
)
ÜÜ 
;
ÜÜ 
}
áá 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
ââ 
return
ãã 

StatusCode
ãã !
(
ãã! "
$num
ãã" %
,
ãã% &
new
ãã' *
{
ãã+ ,
message
ãã- 4
=
ãã5 6
$str
ãã7 b
}
ããc d
)
ããd e
;
ããe f
}
åå 
}
çç 	
}
éé 
}èè Á†
?D:\backendkb\KnowledgeBase.Api\Controller\ArticlesController.cs
	namespace

 	
KnowledgeBase


 
.

 
Api

 
.

 
Controllers

 '
;

' (
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
public 
class 
ArticlesController 
:  !
ControllerBase" 0
{ 
private 
readonly 
AppDbContext !
_db" %
;% &
public 

ArticlesController 
( 
AppDbContext *
db+ -
)- .
=>/ 1
_db2 5
=6 7
db8 :
;: ;
int 
? 
CurrentUserId	 
=> 
int 
. 
TryParse &
(& '
User' +
.+ ,
FindFirstValue, :
(: ;

ClaimTypes; E
.E F
NameIdentifierF T
)T U
,U V
outW Z
var[ ^
id_ a
)a b
?c d
ide g
:h i
nullj n
;n o
bool 
IsAdmin	 
=> 
User 
. 
IsInRole !
(! "
$str" )
)) *
;* +
bool 
IsContributor	 
=> 
User 
. 
IsInRole '
(' (
$str( 5
)5 6
;6 7
bool 

IsUserRole	 
=> 
User 
. 
IsInRole $
($ %
$str% +
)+ ,
;, -
[ 
HttpPost 
] 
[ 
	Authorize 
( 
Policy 
= 
$str )
)) *
]* +
public 

async 
Task 
< 
ActionResult "
<" #
ArticleResponse# 2
>2 3
>3 4
Create5 ;
(; <
[< =
FromBody= E
]E F 
CreateArticleRequestG [
req\ _
)_ `
{ 
var 
authorId 
= 
CurrentUserId $
!$ %
.% &
Value& +
;+ ,
var 
exists 
= 
await 
_db 
. 

Categories )
.) *
AnyAsync* 2
(2 3
c3 4
=>5 7
c8 9
.9 :
Id: <
=== ?
req@ C
.C D

CategoryIdD N
)N O
;O P
if 

( 
! 
exists 
) 
return 

BadRequest &
(& '
$str' :
): ;
;; <
var!! 
a!! 
=!! 
new!! 
Article!! 
{"" 	
Name## 
=## 
req## 
.## 
Name## 
,## 
Description$$ 
=$$ 
req$$ 
.$$ 
Description$$ )
,$$) *
Content%% 
=%% 
req%% 
.%% 
Content%% !
,%%! "

CategoryId&& 
=&& 
req&& 
.&& 

CategoryId&& '
,&&' (
AuthorId'' 
='' 
authorId'' 
,''  
Status(( 
=(( 
ArticleStatus(( "
.((" #
Pending((# *
,((* +
	DriveLink)) 
=)) 
req)) 
.)) 
	DriveLink)) %
}** 	
;**	 

_db++ 
.++ 
Articles++ 
.++ 
Add++ 
(++ 
a++ 
)++ 
;++ 
await,, 
_db,, 
.,, 
SaveChangesAsync,, "
(,," #
),,# $
;,,$ %
var.. 
category.. 
=.. 
await.. 
_db..  
...  !

Categories..! +
...+ ,
	FindAsync.., 5
(..5 6
a..6 7
...7 8

CategoryId..8 B
)..B C
;..C D
var// 
author// 
=// 
await// 
_db// 
.// 
Users// $
.//$ %
	FindAsync//% .
(//. /
authorId/// 7
)//7 8
;//8 9
return11 
Ok11 
(11 
new11 
ArticleResponse11 %
{22 	
Id33 
=33 
a33 
.33 
Id33 
,33 
Name44 
=44 
a44 
.44 
Name44 
,44 
Description55 
=55 
a55 
.55 
Description55 '
,55' (
Content66 
=66 
a66 
.66 
Content66 
,66  

CategoryId77 
=77 
a77 
.77 

CategoryId77 %
,77% &
CategoryName88 
=88 
category88 #
!88# $
.88$ %
Name88% )
,88) *
AuthorId99 
=99 
authorId99 
,99  

AuthorName:: 
=:: 
author:: 
!::  
.::  !
Name::! %
,::% &
Status;; 
=;; 
a;; 
.;; 
Status;; 
.;; 
ToString;; &
(;;& '
);;' (
,;;( )
RejectReason<< 
=<< 
a<< 
.<< 
RejectReason<< )
,<<) *

ApprovedAt== 
=== 
a== 
.== 

ApprovedAt== %
,==% &
	ViewCount>> 
=>> 
a>> 
.>> 
	ViewCount>> #
,>># $
	DriveLink?? 
=?? 
a?? 
.?? 
	DriveLink?? #
,??# $
	CreatedAt@@ 
=@@ 
a@@ 
.@@ 
	CreatedAt@@ #
}AA 	
)AA	 

;AA
 
}BB 
[EE 
HttpPutEE 
(EE 
$strEE 
)EE 
]EE 
[FF 
	AuthorizeFF 
(FF 
PolicyFF 
=FF 
$strFF )
)FF) *
]FF* +
publicGG 

asyncGG 
TaskGG 
<GG 
IActionResultGG #
>GG# $
UpdateGG% +
(GG+ ,
intGG, /
idGG0 2
,GG2 3
[GG4 5
FromBodyGG5 =
]GG= > 
UpdateArticleRequestGG? S
reqGGT W
)GGW X
{HH 
varII 
authorIdII 
=II 
CurrentUserIdII $
!II$ %
.II% &
ValueII& +
;II+ ,
varJJ 
aJJ 
=JJ 
awaitJJ 
_dbJJ 
.JJ 
ArticlesJJ "
.JJ" #
FirstOrDefaultAsyncJJ# 6
(JJ6 7
xJJ7 8
=>JJ9 ;
xJJ< =
.JJ= >
IdJJ> @
==JJA C
idJJD F
&&JJG I
xJJJ K
.JJK L
AuthorIdJJL T
==JJU W
authorIdJJX `
)JJ` a
;JJa b
ifKK 

(KK 
aKK 
==KK 
nullKK 
)KK 
returnKK 
NotFoundKK &
(KK& '
)KK' (
;KK( )
ifMM 

(MM 
reqMM 
.MM 

CategoryIdMM 
.MM 
HasValueMM #
&&MM$ &
!MM' (
awaitMM( -
_dbMM. 1
.MM1 2

CategoriesMM2 <
.MM< =
AnyAsyncMM= E
(MME F
cMMF G
=>MMH J
cMMK L
.MML M
IdMMM O
==MMP R
reqMMS V
.MMV W

CategoryIdMMW a
.MMa b
ValueMMb g
)MMg h
)MMh i
returnNN 

BadRequestNN 
(NN 
$strNN 1
)NN1 2
;NN2 3
ifPP 

(PP 
reqPP 
.PP 
NamePP 
!=PP 
nullPP 
)PP 
aPP 
.PP  
NamePP  $
=PP% &
reqPP' *
.PP* +
NamePP+ /
;PP/ 0
ifQQ 

(QQ 
reqQQ 
.QQ 
DescriptionQQ 
!=QQ 
nullQQ #
)QQ# $
aQQ% &
.QQ& '
DescriptionQQ' 2
=QQ3 4
reqQQ5 8
.QQ8 9
DescriptionQQ9 D
;QQD E
ifRR 

(RR 
reqRR 
.RR 
ContentRR 
!=RR 
nullRR 
)RR  
aRR! "
.RR" #
ContentRR# *
=RR+ ,
reqRR- 0
.RR0 1
ContentRR1 8
;RR8 9
ifSS 

(SS 
reqSS 
.SS 

CategoryIdSS 
.SS 
HasValueSS #
)SS# $
aSS% &
.SS& '

CategoryIdSS' 1
=SS2 3
reqSS4 7
.SS7 8

CategoryIdSS8 B
.SSB C
ValueSSC H
;SSH I
ifTT 

(TT 
reqTT 
.TT 
	DriveLinkTT 
!=TT 
nullTT !
)TT! "
aTT# $
.TT$ %
	DriveLinkTT% .
=TT/ 0
reqTT1 4
.TT4 5
	DriveLinkTT5 >
;TT> ?
ifWW 

(WW 
aWW 
.WW 
StatusWW 
==WW 
ArticleStatusWW %
.WW% &
ApprovedWW& .
)WW. /
{XX 	
aYY 
.YY 
StatusYY 
=YY 
ArticleStatusYY $
.YY$ %
PendingYY% ,
;YY, -
aZZ 
.ZZ 

ApprovedAtZZ 
=ZZ 
nullZZ 
;ZZ  
a[[ 
.[[ 
RejectReason[[ 
=[[ 
null[[ !
;[[! "
}\\ 	
else]] 
if]] 
(]] 
a]] 
.]] 
Status]] 
==]] 
ArticleStatus]] *
.]]* +
Rejected]]+ 3
)]]3 4
{^^ 	
a__ 
.__ 
Status__ 
=__ 
ArticleStatus__ $
.__$ %
Pending__% ,
;__, -
a`` 
.`` 
RejectReason`` 
=`` 
null`` !
;``! "
}aa 	
acc 	
.cc	 

	UpdatedAtcc
 
=cc 
DateTimecc 
.cc 
UtcNowcc %
;cc% &
awaitdd 
_dbdd 
.dd 
SaveChangesAsyncdd "
(dd" #
)dd# $
;dd$ %
returnee 
	NoContentee 
(ee 
)ee 
;ee 
}ff 
[ii 

HttpDeleteii 
(ii 
$strii 
)ii 
]ii 
[jj 
	Authorizejj 
(jj 
Policyjj 
=jj 
$strjj )
)jj) *
]jj* +
publickk 

asynckk 
Taskkk 
<kk 
IActionResultkk #
>kk# $
Deletekk% +
(kk+ ,
intkk, /
idkk0 2
)kk2 3
{ll 
varmm 
authorIdmm 
=mm 
CurrentUserIdmm $
!mm$ %
.mm% &
Valuemm& +
;mm+ ,
varnn 
ann 
=nn 
awaitnn 
_dbnn 
.nn 
Articlesnn "
.nn" #
FirstOrDefaultAsyncnn# 6
(nn6 7
xnn7 8
=>nn9 ;
xnn< =
.nn= >
Idnn> @
==nnA C
idnnD F
&&nnG I
xnnJ K
.nnK L
AuthorIdnnL T
==nnU W
authorIdnnX `
)nn` a
;nna b
ifoo 

(oo 
aoo 
==oo 
nulloo 
)oo 
returnoo 
NotFoundoo &
(oo& '
)oo' (
;oo( )
_dbpp 
.pp 
Articlespp 
.pp 
Removepp 
(pp 
app 
)pp 
;pp 
awaitqq 
_dbqq 
.qq 
SaveChangesAsyncqq "
(qq" #
)qq# $
;qq$ %
returnrr 
	NoContentrr 
(rr 
)rr 
;rr 
}ss 
[vv 
HttpGetvv 
(vv 
$strvv 
)vv 
]vv 
[ww 
	Authorizeww 
(ww 
Policyww 
=ww 
$strww )
)ww) *
]ww* +
publicxx 

asyncxx 
Taskxx 
<xx 
ActionResultxx "
<xx" #
IEnumerablexx# .
<xx. /
ArticleResponsexx/ >
>xx> ?
>xx? @
>xx@ A
MinexxB F
(xxF G
)xxG H
{yy 
varzz 
authorIdzz 
=zz 
CurrentUserIdzz $
!zz$ %
.zz% &
Valuezz& +
;zz+ ,
var{{ 
list{{ 
={{ 
await{{ 
_db{{ 
.{{ 
Articles{{ %
.|| 
Include|| 
(|| 
a|| 
=>|| 
a|| 
.|| 
Category|| $
)||$ %
.}} 
Where}} 
(}} 
a}} 
=>}} 
a}} 
.}} 
AuthorId}} "
==}}# %
authorId}}& .
)}}. /
.~~ 
OrderByDescending~~ 
(~~ 
a~~  
=>~~! #
a~~$ %
.~~% &
	CreatedAt~~& /
)~~/ 0
. 
Select 
( 
a 
=> 
new 
ArticleResponse ,
{
ÄÄ 
Id
ÅÅ 
=
ÅÅ 
a
ÅÅ 
.
ÅÅ 
Id
ÅÅ 
,
ÅÅ 
Name
ÇÇ 
=
ÇÇ 
a
ÇÇ 
.
ÇÇ 
Name
ÇÇ 
,
ÇÇ 
Description
ÉÉ 
=
ÉÉ 
a
ÉÉ 
.
ÉÉ  
Description
ÉÉ  +
,
ÉÉ+ ,
Content
ÑÑ 
=
ÑÑ 
a
ÑÑ 
.
ÑÑ 
Content
ÑÑ #
,
ÑÑ# $

CategoryId
ÖÖ 
=
ÖÖ 
a
ÖÖ 
.
ÖÖ 

CategoryId
ÖÖ )
,
ÖÖ) *
CategoryName
ÜÜ 
=
ÜÜ 
a
ÜÜ  
.
ÜÜ  !
Category
ÜÜ! )
.
ÜÜ) *
Name
ÜÜ* .
,
ÜÜ. /
AuthorId
áá 
=
áá 
a
áá 
.
áá 
AuthorId
áá %
,
áá% &

AuthorName
àà 
=
àà 
User
àà !
.
àà! "
Identity
àà" *
!
àà* +
.
àà+ ,
Name
àà, 0
??
àà1 3
$str
àà4 8
,
àà8 9
Status
ââ 
=
ââ 
a
ââ 
.
ââ 
Status
ââ !
.
ââ! "
ToString
ââ" *
(
ââ* +
)
ââ+ ,
,
ââ, -
RejectReason
ää 
=
ää 
a
ää  
.
ää  !
RejectReason
ää! -
,
ää- .

ApprovedAt
ãã 
=
ãã 
a
ãã 
.
ãã 

ApprovedAt
ãã )
,
ãã) *
	ViewCount
åå 
=
åå 
a
åå 
.
åå 
	ViewCount
åå '
,
åå' (
	DriveLink
çç 
=
çç 
a
çç 
.
çç 
	DriveLink
çç '
,
çç' (
	CreatedAt
éé 
=
éé 
a
éé 
.
éé 
	CreatedAt
éé '
}
èè 
)
èè 
.
êê 
ToListAsync
êê 
(
êê 
)
êê 
;
êê 
return
íí 
Ok
íí 
(
íí 
list
íí 
)
íí 
;
íí 
}
ìì 
[
ññ 
HttpGet
ññ 
]
ññ 
[
óó 
	Authorize
óó 
(
óó 
Policy
óó 
=
óó 
$str
óó *
)
óó* +
]
óó+ ,
public
òò 

async
òò 
Task
òò 
<
òò 
ActionResult
òò "
<
òò" #
IEnumerable
òò# .
<
òò. /
ArticleResponse
òò/ >
>
òò> ?
>
òò? @
>
òò@ A
Browse
òòB H
(
òòH I
[
ôô 	
	FromQuery
ôô	 
]
ôô 
string
ôô 
?
ôô 
q
ôô 
,
ôô 
[
öö 	
	FromQuery
öö	 
]
öö 
int
öö 
?
öö 

categoryId
öö #
,
öö# $
[
õõ 	
	FromQuery
õõ	 
]
õõ 
string
õõ 
sort
õõ 
=
õõ  !
$str
õõ" *
,
õõ* +
[
úú 	
	FromQuery
úú	 
]
úú 
int
úú 
page
úú 
=
úú 
$num
úú  
,
úú  !
[
ùù 	
	FromQuery
ùù	 
]
ùù 
int
ùù 
pageSize
ùù  
=
ùù! "
$num
ùù# %
)
ùù% &
{
ûû 
var
üü 
query
üü 
=
üü 
_db
üü 
.
üü 
Articles
üü  
.
†† 
Include
†† 
(
†† 
a
†† 
=>
†† 
a
†† 
.
†† 
Category
†† $
)
††$ %
.
°° 
Include
°° 
(
°° 
a
°° 
=>
°° 
a
°° 
.
°° 
Author
°° "
)
°°" #
.
¢¢ 
Where
¢¢ 
(
¢¢ 
a
¢¢ 
=>
¢¢ 
a
¢¢ 
.
¢¢ 
Status
¢¢  
==
¢¢! #
ArticleStatus
¢¢$ 1
.
¢¢1 2
Approved
¢¢2 :
)
¢¢: ;
.
££ 
AsQueryable
££ 
(
££ 
)
££ 
;
££ 
if
•• 

(
•• 
!
•• 
string
•• 
.
••  
IsNullOrWhiteSpace
•• &
(
••& '
q
••' (
)
••( )
)
••) *
query
¶¶ 
=
¶¶ 
query
¶¶ 
.
¶¶ 
Where
¶¶ 
(
¶¶  
a
¶¶  !
=>
¶¶" $
a
¶¶% &
.
¶¶& '
Name
¶¶' +
.
¶¶+ ,
Contains
¶¶, 4
(
¶¶4 5
q
¶¶5 6
)
¶¶6 7
||
¶¶8 :
a
¶¶; <
.
¶¶< =
Description
¶¶= H
.
¶¶H I
Contains
¶¶I Q
(
¶¶Q R
q
¶¶R S
)
¶¶S T
)
¶¶T U
;
¶¶U V
if
®® 

(
®® 

categoryId
®® 
.
®® 
HasValue
®® 
)
®®  
query
©© 
=
©© 
query
©© 
.
©© 
Where
©© 
(
©©  
a
©©  !
=>
©©" $
a
©©% &
.
©©& '

CategoryId
©©' 1
==
©©2 4

categoryId
©©5 ?
.
©©? @
Value
©©@ E
)
©©E F
;
©©F G
query
´´ 
=
´´ 
sort
´´ 
==
´´ 
$str
´´ 
?
¨¨ 
query
¨¨ 
.
¨¨ 
OrderByDescending
¨¨ %
(
¨¨% &
a
¨¨& '
=>
¨¨( *
a
¨¨+ ,
.
¨¨, -
	ViewCount
¨¨- 6
)
¨¨6 7
.
¨¨7 8
ThenByDescending
¨¨8 H
(
¨¨H I
a
¨¨I J
=>
¨¨K M
a
¨¨N O
.
¨¨O P

ApprovedAt
¨¨P Z
)
¨¨Z [
:
≠≠ 
query
≠≠ 
.
≠≠ 
OrderByDescending
≠≠ %
(
≠≠% &
a
≠≠& '
=>
≠≠( *
a
≠≠+ ,
.
≠≠, -

ApprovedAt
≠≠- 7
)
≠≠7 8
.
≠≠8 9
ThenByDescending
≠≠9 I
(
≠≠I J
a
≠≠J K
=>
≠≠L N
a
≠≠O P
.
≠≠P Q
	CreatedAt
≠≠Q Z
)
≠≠Z [
;
≠≠[ \
var
ØØ 
skip
ØØ 
=
ØØ 
(
ØØ 
page
ØØ 
-
ØØ 
$num
ØØ 
)
ØØ 
*
ØØ 
pageSize
ØØ  (
;
ØØ( )
var
∞∞ 
list
∞∞ 
=
∞∞ 
await
∞∞ 
query
∞∞ 
.
∞∞ 
Skip
∞∞ #
(
∞∞# $
skip
∞∞$ (
)
∞∞( )
.
∞∞) *
Take
∞∞* .
(
∞∞. /
pageSize
∞∞/ 7
)
∞∞7 8
.
∞∞8 9
Select
∞∞9 ?
(
∞∞? @
a
∞∞@ A
=>
∞∞B D
new
∞∞E H
ArticleResponse
∞∞I X
{
±± 	
Id
≤≤ 
=
≤≤ 
a
≤≤ 
.
≤≤ 
Id
≤≤ 
,
≤≤ 
Name
≥≥ 
=
≥≥ 
a
≥≥ 
.
≥≥ 
Name
≥≥ 
,
≥≥ 
Description
¥¥ 
=
¥¥ 
a
¥¥ 
.
¥¥ 
Description
¥¥ '
,
¥¥' (
Content
µµ 
=
µµ 
a
µµ 
.
µµ 
Content
µµ 
,
µµ  

CategoryId
∂∂ 
=
∂∂ 
a
∂∂ 
.
∂∂ 

CategoryId
∂∂ %
,
∂∂% &
CategoryName
∑∑ 
=
∑∑ 
a
∑∑ 
.
∑∑ 
Category
∑∑ %
.
∑∑% &
Name
∑∑& *
,
∑∑* +
AuthorId
∏∏ 
=
∏∏ 
a
∏∏ 
.
∏∏ 
AuthorId
∏∏ !
,
∏∏! "

AuthorName
ππ 
=
ππ 
a
ππ 
.
ππ 
Author
ππ !
.
ππ! "
Name
ππ" &
,
ππ& '
Status
∫∫ 
=
∫∫ 
a
∫∫ 
.
∫∫ 
Status
∫∫ 
.
∫∫ 
ToString
∫∫ &
(
∫∫& '
)
∫∫' (
,
∫∫( )
RejectReason
ªª 
=
ªª 
a
ªª 
.
ªª 
RejectReason
ªª )
,
ªª) *

ApprovedAt
ºº 
=
ºº 
a
ºº 
.
ºº 

ApprovedAt
ºº %
,
ºº% &
	ViewCount
ΩΩ 
=
ΩΩ 
a
ΩΩ 
.
ΩΩ 
	ViewCount
ΩΩ #
,
ΩΩ# $
	DriveLink
ææ 
=
ææ 
a
ææ 
.
ææ 
	DriveLink
ææ #
,
ææ# $
	CreatedAt
øø 
=
øø 
a
øø 
.
øø 
	CreatedAt
øø #
}
¿¿ 	
)
¿¿	 

.
¿¿
 
ToListAsync
¿¿ 
(
¿¿ 
)
¿¿ 
;
¿¿ 
return
¬¬ 
Ok
¬¬ 
(
¬¬ 
list
¬¬ 
)
¬¬ 
;
¬¬ 
}
√√ 
[
∆∆ 
HttpGet
∆∆ 
(
∆∆ 
$str
∆∆ 
)
∆∆ 
]
∆∆ 
[
«« 
	Authorize
«« 
(
«« 
Policy
«« 
=
«« 
$str
«« *
)
««* +
]
««+ ,
public
»» 

async
»» 
Task
»» 
<
»» 
ActionResult
»» "
<
»»" #
ArticleResponse
»»# 2
>
»»2 3
>
»»3 4
Get
»»5 8
(
»»8 9
int
»»9 <
id
»»= ?
)
»»? @
{
…… 
var
   
a
   
=
   
await
   
_db
   
.
   
Articles
   "
.
ÀÀ 
Include
ÀÀ 
(
ÀÀ 
x
ÀÀ 
=>
ÀÀ 
x
ÀÀ 
.
ÀÀ 
Category
ÀÀ $
)
ÀÀ$ %
.
ÃÃ 
Include
ÃÃ 
(
ÃÃ 
x
ÃÃ 
=>
ÃÃ 
x
ÃÃ 
.
ÃÃ 
Author
ÃÃ "
)
ÃÃ" #
.
ÕÕ !
FirstOrDefaultAsync
ÕÕ  
(
ÕÕ  !
x
ÕÕ! "
=>
ÕÕ# %
x
ÕÕ& '
.
ÕÕ' (
Id
ÕÕ( *
==
ÕÕ+ -
id
ÕÕ. 0
)
ÕÕ0 1
;
ÕÕ1 2
if
œœ 

(
œœ 
a
œœ 
==
œœ 
null
œœ 
)
œœ 
return
œœ 
NotFound
œœ &
(
œœ& '
)
œœ' (
;
œœ( )
if
—— 

(
—— 
a
—— 
.
—— 
Status
—— 
!=
—— 
ArticleStatus
—— %
.
——% &
Approved
——& .
&&
——/ 1
!
——2 3
IsAdmin
——3 :
&&
——; =
a
——> ?
.
——? @
AuthorId
——@ H
!=
——I K
CurrentUserId
——L Y
)
——Y Z
return
““ 
Forbid
““ 
(
““ 
)
““ 
;
““ 
return
‘‘ 
Ok
‘‘ 
(
‘‘ 
new
‘‘ 
ArticleResponse
‘‘ %
{
’’ 	
Id
÷÷ 
=
÷÷ 
a
÷÷ 
.
÷÷ 
Id
÷÷ 
,
÷÷ 
Name
◊◊ 
=
◊◊ 
a
◊◊ 
.
◊◊ 
Name
◊◊ 
,
◊◊ 
Description
ÿÿ 
=
ÿÿ 
a
ÿÿ 
.
ÿÿ 
Description
ÿÿ '
,
ÿÿ' (
Content
ŸŸ 
=
ŸŸ 
a
ŸŸ 
.
ŸŸ 
Content
ŸŸ 
,
ŸŸ  

CategoryId
⁄⁄ 
=
⁄⁄ 
a
⁄⁄ 
.
⁄⁄ 

CategoryId
⁄⁄ %
,
⁄⁄% &
CategoryName
€€ 
=
€€ 
a
€€ 
.
€€ 
Category
€€ %
.
€€% &
Name
€€& *
,
€€* +
AuthorId
‹‹ 
=
‹‹ 
a
‹‹ 
.
‹‹ 
AuthorId
‹‹ !
,
‹‹! "

AuthorName
›› 
=
›› 
a
›› 
.
›› 
Author
›› !
.
››! "
Name
››" &
,
››& '
Status
ﬁﬁ 
=
ﬁﬁ 
a
ﬁﬁ 
.
ﬁﬁ 
Status
ﬁﬁ 
.
ﬁﬁ 
ToString
ﬁﬁ &
(
ﬁﬁ& '
)
ﬁﬁ' (
,
ﬁﬁ( )
RejectReason
ﬂﬂ 
=
ﬂﬂ 
a
ﬂﬂ 
.
ﬂﬂ 
RejectReason
ﬂﬂ )
,
ﬂﬂ) *

ApprovedAt
‡‡ 
=
‡‡ 
a
‡‡ 
.
‡‡ 

ApprovedAt
‡‡ %
,
‡‡% &
	ViewCount
·· 
=
·· 
a
·· 
.
·· 
	ViewCount
·· #
,
··# $
	DriveLink
‚‚ 
=
‚‚ 
a
‚‚ 
.
‚‚ 
	DriveLink
‚‚ #
,
‚‚# $
	CreatedAt
„„ 
=
„„ 
a
„„ 
.
„„ 
	CreatedAt
„„ #
}
‰‰ 	
)
‰‰	 

;
‰‰
 
}
ÂÂ 
[
ËË 
HttpPost
ËË 
(
ËË 
$str
ËË 
)
ËË 
]
ËË 
[
ÈÈ 
	Authorize
ÈÈ 
(
ÈÈ 
Policy
ÈÈ 
=
ÈÈ 
$str
ÈÈ *
)
ÈÈ* +
]
ÈÈ+ ,
public
ÍÍ 

async
ÍÍ 
Task
ÍÍ 
<
ÍÍ 
IActionResult
ÍÍ #
>
ÍÍ# $

RecordView
ÍÍ% /
(
ÍÍ/ 0
int
ÍÍ0 3
id
ÍÍ4 6
)
ÍÍ6 7
{
ÎÎ 
var
ÏÏ 
a
ÏÏ 
=
ÏÏ 
await
ÏÏ 
_db
ÏÏ 
.
ÏÏ 
Articles
ÏÏ "
.
ÏÏ" #
	FindAsync
ÏÏ# ,
(
ÏÏ, -
id
ÏÏ- /
)
ÏÏ/ 0
;
ÏÏ0 1
if
ÌÌ 

(
ÌÌ 
a
ÌÌ 
==
ÌÌ 
null
ÌÌ 
)
ÌÌ 
return
ÌÌ 
NotFound
ÌÌ &
(
ÌÌ& '
)
ÌÌ' (
;
ÌÌ( )
if
ÓÓ 

(
ÓÓ 
a
ÓÓ 
.
ÓÓ 
Status
ÓÓ 
!=
ÓÓ 
ArticleStatus
ÓÓ %
.
ÓÓ% &
Approved
ÓÓ& .
&&
ÓÓ/ 1
!
ÓÓ2 3
IsAdmin
ÓÓ3 :
&&
ÓÓ; =
a
ÓÓ> ?
.
ÓÓ? @
AuthorId
ÓÓ@ H
!=
ÓÓI K
CurrentUserId
ÓÓL Y
)
ÓÓY Z
return
ÔÔ 
Forbid
ÔÔ 
(
ÔÔ 
)
ÔÔ 
;
ÔÔ 
_db
ÒÒ 
.
ÒÒ 
ArticleViews
ÒÒ 
.
ÒÒ 
Add
ÒÒ 
(
ÒÒ 
new
ÒÒ  
ArticleView
ÒÒ! ,
{
ÚÚ 	
	ArticleId
ÛÛ 
=
ÛÛ 
id
ÛÛ 
,
ÛÛ 
UserId
ÙÙ 
=
ÙÙ 
CurrentUserId
ÙÙ "
}
ıı 	
)
ıı	 

;
ıı
 
a
ˆˆ 	
.
ˆˆ	 

	ViewCount
ˆˆ
 
+=
ˆˆ 
$num
ˆˆ 
;
ˆˆ 
await
˜˜ 
_db
˜˜ 
.
˜˜ 
SaveChangesAsync
˜˜ "
(
˜˜" #
)
˜˜# $
;
˜˜$ %
return
¯¯ 
	NoContent
¯¯ 
(
¯¯ 
)
¯¯ 
;
¯¯ 
}
˘˘ 
[
¸¸ 
HttpPost
¸¸ 
(
¸¸ 
$str
¸¸  
)
¸¸  !
]
¸¸! "
[
˝˝ 
	Authorize
˝˝ 
(
˝˝ 
Policy
˝˝ 
=
˝˝ 
$str
˝˝ #
)
˝˝# $
]
˝˝$ %
public
˛˛ 

async
˛˛ 
Task
˛˛ 
<
˛˛ 
IActionResult
˛˛ #
>
˛˛# $
Approve
˛˛% ,
(
˛˛, -
int
˛˛- 0
id
˛˛1 3
)
˛˛3 4
{
ˇˇ 
var
ÄÄ 
a
ÄÄ 
=
ÄÄ 
await
ÄÄ 
_db
ÄÄ 
.
ÄÄ 
Articles
ÄÄ "
.
ÄÄ" #
	FindAsync
ÄÄ# ,
(
ÄÄ, -
id
ÄÄ- /
)
ÄÄ/ 0
;
ÄÄ0 1
if
ÅÅ 

(
ÅÅ 
a
ÅÅ 
==
ÅÅ 
null
ÅÅ 
)
ÅÅ 
return
ÅÅ 
NotFound
ÅÅ &
(
ÅÅ& '
)
ÅÅ' (
;
ÅÅ( )
a
ÉÉ 	
.
ÉÉ	 

Status
ÉÉ
 
=
ÉÉ 
ArticleStatus
ÉÉ  
.
ÉÉ  !
Approved
ÉÉ! )
;
ÉÉ) *
a
ÑÑ 	
.
ÑÑ	 


ApprovedAt
ÑÑ
 
=
ÑÑ 
DateTime
ÑÑ 
.
ÑÑ  
UtcNow
ÑÑ  &
;
ÑÑ& '
a
ÖÖ 	
.
ÖÖ	 

RejectReason
ÖÖ
 
=
ÖÖ 
null
ÖÖ 
;
ÖÖ 
a
ÜÜ 	
.
ÜÜ	 

	UpdatedAt
ÜÜ
 
=
ÜÜ 
DateTime
ÜÜ 
.
ÜÜ 
UtcNow
ÜÜ %
;
ÜÜ% &
await
àà 
_db
àà 
.
àà 
SaveChangesAsync
àà "
(
àà" #
)
àà# $
;
àà$ %
return
ââ 
	NoContent
ââ 
(
ââ 
)
ââ 
;
ââ 
}
ää 
[
çç 
HttpPost
çç 
(
çç 
$str
çç 
)
çç  
]
çç  !
[
éé 
	Authorize
éé 
(
éé 
Policy
éé 
=
éé 
$str
éé #
)
éé# $
]
éé$ %
public
èè 

async
èè 
Task
èè 
<
èè 
IActionResult
èè #
>
èè# $
Reject
èè% +
(
èè+ ,
int
èè, /
id
èè0 2
,
èè2 3
[
èè4 5
FromBody
èè5 =
]
èè= >"
RejectArticleRequest
èè? S
req
èèT W
)
èèW X
{
êê 
var
ëë 
a
ëë 
=
ëë 
await
ëë 
_db
ëë 
.
ëë 
Articles
ëë "
.
ëë" #
	FindAsync
ëë# ,
(
ëë, -
id
ëë- /
)
ëë/ 0
;
ëë0 1
if
íí 

(
íí 
a
íí 
==
íí 
null
íí 
)
íí 
return
íí 
NotFound
íí &
(
íí& '
)
íí' (
;
íí( )
if
îî 

(
îî 
string
îî 
.
îî  
IsNullOrWhiteSpace
îî %
(
îî% &
req
îî& )
.
îî) *
Reason
îî* 0
)
îî0 1
)
îî1 2
return
ïï 

BadRequest
ïï 
(
ïï 
$str
ïï =
)
ïï= >
;
ïï> ?
a
óó 	
.
óó	 

Status
óó
 
=
óó 
ArticleStatus
óó  
.
óó  !
Rejected
óó! )
;
óó) *
a
òò 	
.
òò	 

RejectReason
òò
 
=
òò 
req
òò 
.
òò 
Reason
òò #
;
òò# $
a
ôô 	
.
ôô	 


ApprovedAt
ôô
 
=
ôô 
null
ôô 
;
ôô 
a
öö 	
.
öö	 

	UpdatedAt
öö
 
=
öö 
DateTime
öö 
.
öö 
UtcNow
öö %
;
öö% &
await
úú 
_db
úú 
.
úú 
SaveChangesAsync
úú "
(
úú" #
)
úú# $
;
úú$ %
return
ùù 
	NoContent
ùù 
(
ùù 
)
ùù 
;
ùù 
}
ûû 
[
°° 
HttpGet
°° 
(
°° 
$str
°° 
)
°° 
]
°° 
[
¢¢ 
	Authorize
¢¢ 
(
¢¢ 
Policy
¢¢ 
=
¢¢ 
$str
¢¢ #
)
¢¢# $
]
¢¢$ %
public
££ 

async
££ 
Task
££ 
<
££ 
ActionResult
££ "
<
££" #
IEnumerable
££# .
<
££. /
ArticleResponse
££/ >
>
££> ?
>
££? @
>
££@ A 
GetPendingArticles
££B T
(
££T U
)
££U V
{
§§ 
var
•• 
list
•• 
=
•• 
await
•• 
_db
•• 
.
•• 
Articles
•• %
.
¶¶ 
Include
¶¶ 
(
¶¶ 
a
¶¶ 
=>
¶¶ 
a
¶¶ 
.
¶¶ 
Category
¶¶ $
)
¶¶$ %
.
ßß 
Include
ßß 
(
ßß 
a
ßß 
=>
ßß 
a
ßß 
.
ßß 
Author
ßß "
)
ßß" #
.
®® 
Where
®® 
(
®® 
a
®® 
=>
®® 
a
®® 
.
®® 
Status
®®  
==
®®! #
ArticleStatus
®®$ 1
.
®®1 2
Pending
®®2 9
)
®®9 :
.
©© 
OrderByDescending
©© 
(
©© 
a
©©  
=>
©©! #
a
©©$ %
.
©©% &
	CreatedAt
©©& /
)
©©/ 0
.
™™ 
Select
™™ 
(
™™ 
a
™™ 
=>
™™ 
new
™™ 
ArticleResponse
™™ ,
{
´´ 
Id
¨¨ 
=
¨¨ 
a
¨¨ 
.
¨¨ 
Id
¨¨ 
,
¨¨ 
Name
≠≠ 
=
≠≠ 
a
≠≠ 
.
≠≠ 
Name
≠≠ 
,
≠≠ 
Description
ÆÆ 
=
ÆÆ 
a
ÆÆ 
.
ÆÆ  
Description
ÆÆ  +
,
ÆÆ+ ,
Content
ØØ 
=
ØØ 
a
ØØ 
.
ØØ 
Content
ØØ #
,
ØØ# $

CategoryId
∞∞ 
=
∞∞ 
a
∞∞ 
.
∞∞ 

CategoryId
∞∞ )
,
∞∞) *
CategoryName
±± 
=
±± 
a
±±  
.
±±  !
Category
±±! )
.
±±) *
Name
±±* .
,
±±. /
AuthorId
≤≤ 
=
≤≤ 
a
≤≤ 
.
≤≤ 
AuthorId
≤≤ %
,
≤≤% &

AuthorName
≥≥ 
=
≥≥ 
a
≥≥ 
.
≥≥ 
Author
≥≥ %
.
≥≥% &
Name
≥≥& *
,
≥≥* +
Status
¥¥ 
=
¥¥ 
a
¥¥ 
.
¥¥ 
Status
¥¥ !
.
¥¥! "
ToString
¥¥" *
(
¥¥* +
)
¥¥+ ,
,
¥¥, -
RejectReason
µµ 
=
µµ 
a
µµ  
.
µµ  !
RejectReason
µµ! -
,
µµ- .

ApprovedAt
∂∂ 
=
∂∂ 
a
∂∂ 
.
∂∂ 

ApprovedAt
∂∂ )
,
∂∂) *
	ViewCount
∑∑ 
=
∑∑ 
a
∑∑ 
.
∑∑ 
	ViewCount
∑∑ '
,
∑∑' (
	DriveLink
∏∏ 
=
∏∏ 
a
∏∏ 
.
∏∏ 
	DriveLink
∏∏ '
,
∏∏' (
	CreatedAt
ππ 
=
ππ 
a
ππ 
.
ππ 
	CreatedAt
ππ '
}
∫∫ 
)
∫∫ 
.
ªª 
ToListAsync
ªª 
(
ªª 
)
ªª 
;
ªª 
return
ΩΩ 
Ok
ΩΩ 
(
ΩΩ 
list
ΩΩ 
)
ΩΩ 
;
ΩΩ 
}
ææ 
}¡¡ 
public≈≈ 
class
≈≈ "
RejectArticleRequest
≈≈ !
{∆∆ 
public
«« 

string
«« 
Reason
«« 
{
«« 
get
«« 
;
«« 
set
««  #
;
««# $
}
««% &
=
««' (
default
««) 0
!
««0 1
;
««1 2
}»» πˆ
<D:\backendkb\KnowledgeBase.Api\Controller\AdminController.cs
	namespace

 	
KnowledgeBase


 
.

 
Api

 
.

 
Controllers

 '
;

' (
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
[ 
	Authorize 

(
 
Policy 
= 
$str 
)  
]  !
public 
class 
AdminController 
: 
ControllerBase -
{ 
private 
readonly 
AppDbContext !
_db" %
;% &
public 

AdminController 
( 
AppDbContext '
db( *
)* +
=>, .
_db/ 2
=3 4
db5 7
;7 8
[ 
	Authorize 
( 
Policy 
= 
$str #
)# $
]$ %
[ 
HttpPost 
( 
$str 
) 
] 
public 

async 
Task 
< 
ActionResult "
<" #
CategoryResponse# 3
>3 4
>4 5
CreateCategory6 D
(D E
[E F
FromBodyF N
]N O
CategoryRequestP _
req` c
)c d
{ 
if 

( 
await 
_db 
. 

Categories  
.  !
AnyAsync! )
() *
c* +
=>, .
c/ 0
.0 1
Slug1 5
==6 8
req9 <
.< =
Slug= A
)A B
)B C
return 
Conflict 
( 
$str 2
)2 3
;3 4
var 
c 
= 
new 
Category 
{ 
Name #
=$ %
req& )
.) *
Name* .
,. /
Slug0 4
=5 6
req7 :
.: ;
Slug; ?
,? @
DescriptionA L
=M N
reqO R
.R S
DescriptionS ^
}_ `
;` a
_db 
. 

Categories 
. 
Add 
( 
c 
) 
; 
await 
_db 
. 
SaveChangesAsync "
(" #
)# $
;$ %
return!! 
Ok!! 
(!! 
new!! 
CategoryResponse!! &
{!!' (
Id!!) +
=!!, -
c!!. /
.!!/ 0
Id!!0 2
,!!2 3
Name!!4 8
=!!9 :
c!!; <
.!!< =
Name!!= A
,!!A B
Slug!!C G
=!!H I
c!!J K
.!!K L
Slug!!L P
,!!P Q
Description!!R ]
=!!^ _
c!!` a
.!!a b
Description!!b m
}!!n o
)!!o p
;!!p q
}"" 
[## 
AllowAnonymous## 
]## 
[$$ 
HttpGet$$ 
($$ 
$str$$ 
)$$ 
]$$ 
public%% 

async%% 
Task%% 
<%% 
ActionResult%% "
<%%" #
IEnumerable%%# .
<%%. /
CategoryResponse%%/ ?
>%%? @
>%%@ A
>%%A B
ListCategories%%C Q
(%%Q R
)%%R S
{&& 
var'' 
list'' 
='' 
await'' 
_db'' 
.'' 

Categories'' '
.(( 
OrderBy(( 
((( 
c(( 
=>(( 
c(( 
.(( 
Name((  
)((  !
.)) 
Select)) 
()) 
c)) 
=>)) 
new)) 
CategoryResponse)) -
{)). /
Id))0 2
=))3 4
c))5 6
.))6 7
Id))7 9
,))9 :
Name)); ?
=))@ A
c))B C
.))C D
Name))D H
,))H I
Slug))J N
=))O P
c))Q R
.))R S
Slug))S W
,))W X
Description))Y d
=))e f
c))g h
.))h i
Description))i t
}))u v
)))v w
.** 
ToListAsync** 
(** 
)** 
;** 
return++ 
Ok++ 
(++ 
list++ 
)++ 
;++ 
},, 
[-- 
	Authorize-- 
(-- 
Policy-- 
=-- 
$str-- #
)--# $
]--$ %
[.. 
HttpPut.. 
(.. 
$str.. "
).." #
]..# $
public// 

async// 
Task// 
<// 
IActionResult// #
>//# $
UpdateCategory//% 3
(//3 4
int//4 7
id//8 :
,//: ;
[//< =
FromBody//= E
]//E F
CategoryRequest//G V
req//W Z
)//Z [
{00 
var11 
c11 
=11 
await11 
_db11 
.11 

Categories11 $
.11$ %
	FindAsync11% .
(11. /
id11/ 1
)111 2
;112 3
if22 

(22 
c22 
==22 
null22 
)22 
return22 
NotFound22 &
(22& '
)22' (
;22( )
if44 

(44 
c44 
.44 
Slug44 
!=44 
req44 
.44 
Slug44 
&&44 !
await44" '
_db44( +
.44+ ,

Categories44, 6
.446 7
AnyAsync447 ?
(44? @
x44@ A
=>44B D
x44E F
.44F G
Slug44G K
==44L N
req44O R
.44R S
Slug44S W
)44W X
)44X Y
return55 
Conflict55 
(55 
$str55 2
)552 3
;553 4
c77 	
.77	 

Name77
 
=77 
req77 
.77 
Name77 
;77 
c88 	
.88	 

Slug88
 
=88 
req88 
.88 
Slug88 
;88 
c99 	
.99	 

Description99
 
=99 
req99 
.99 
Description99 '
;99' (
await:: 
_db:: 
.:: 
SaveChangesAsync:: "
(::" #
)::# $
;::$ %
return;; 
	NoContent;; 
(;; 
);; 
;;; 
}<< 
[== 
	Authorize== 
(== 
Policy== 
=== 
$str== $
)==$ %
]==% &
[>> 

HttpDelete>> 
(>> 
$str>> %
)>>% &
]>>& '
public?? 

async?? 
Task?? 
<?? 
IActionResult?? #
>??# $
DeleteCategory??% 3
(??3 4
int??4 7
id??8 :
)??: ;
{@@ 
varAA 
cAA 
=AA 
awaitAA 
_dbAA 
.AA 

CategoriesAA $
.AA$ %
	FindAsyncAA% .
(AA. /
idAA/ 1
)AA1 2
;AA2 3
ifBB 

(BB 
cBB 
==BB 
nullBB 
)BB 
returnBB 
NotFoundBB &
(BB& '
)BB' (
;BB( )
_dbCC 
.CC 

CategoriesCC 
.CC 
RemoveCC 
(CC 
cCC 
)CC  
;CC  !
awaitDD 
_dbDD 
.DD 
SaveChangesAsyncDD "
(DD" #
)DD# $
;DD$ %
returnEE 
	NoContentEE 
(EE 
)EE 
;EE 
}FF 
[II 
	AuthorizeII 
(II 
PolicyII 
=II 
$strII $
)II$ %
]II% &
[JJ 
HttpPostJJ 
(JJ 
$strJJ )
)JJ) *
]JJ* +
publicKK 

asyncKK 
TaskKK 
<KK 
IActionResultKK #
>KK# $
ApproveKK% ,
(KK, -
intKK- 0
idKK1 3
)KK3 4
{LL 
varMM 
aMM 
=MM 
awaitMM 
_dbMM 
.MM 
ArticlesMM "
.MM" #
	FindAsyncMM# ,
(MM, -
idMM- /
)MM/ 0
;MM0 1
ifNN 

(NN 
aNN 
==NN 
nullNN 
)NN 
returnNN 
NotFoundNN &
(NN& '
)NN' (
;NN( )
aOO 	
.OO	 

StatusOO
 
=OO 
ArticleStatusOO  
.OO  !
ApprovedOO! )
;OO) *
aPP 	
.PP	 

RejectReasonPP
 
=PP 
nullPP 
;PP 
aQQ 	
.QQ	 


ApprovedAtQQ
 
=QQ 
DateTimeQQ 
.QQ  
UtcNowQQ  &
;QQ& '
awaitRR 
_dbRR 
.RR 
SaveChangesAsyncRR "
(RR" #
)RR# $
;RR$ %
returnSS 
	NoContentSS 
(SS 
)SS 
;SS 
}TT 
[UU 
	AuthorizeUU 
(UU 
PolicyUU 
=UU 
$strUU $
)UU$ %
]UU% &
[VV 
HttpPostVV 
(VV 
$strVV (
)VV( )
]VV) *
publicWW 

asyncWW 
TaskWW 
<WW 
IActionResultWW #
>WW# $
RejectWW% +
(WW+ ,
intWW, /
idWW0 2
,WW2 3
[WW4 5
FromBodyWW5 =
]WW= >
stringWW? E
reasonWWF L
)WWL M
{XX 
varYY 
aYY 
=YY 
awaitYY 
_dbYY 
.YY 
ArticlesYY "
.YY" #
	FindAsyncYY# ,
(YY, -
idYY- /
)YY/ 0
;YY0 1
ifZZ 

(ZZ 
aZZ 
==ZZ 
nullZZ 
)ZZ 
returnZZ 
NotFoundZZ &
(ZZ& '
)ZZ' (
;ZZ( )
a[[ 	
.[[	 

Status[[
 
=[[ 
ArticleStatus[[  
.[[  !
Rejected[[! )
;[[) *
a\\ 	
.\\	 

RejectReason\\
 
=\\ 
reason\\ 
;\\  
a]] 	
.]]	 


ApprovedAt]]
 
=]] 
null]] 
;]] 
await^^ 
_db^^ 
.^^ 
SaveChangesAsync^^ "
(^^" #
)^^# $
;^^$ %
return__ 
	NoContent__ 
(__ 
)__ 
;__ 
}`` 
[dd 
HttpGetdd 
(dd 
$strdd 
)dd 
]dd 
publicee 
asyncee 
Taskee 
<ee 
ActionResultee 
<ee 
IEnumerableee *
<ee* +
ArticleResponseee+ :
>ee: ;
>ee; <
>ee< =
Searchee> D
(eeD E
[eeE F
	FromQueryeeF O
]eeO P
stringeeQ W
?eeW X
qeeY Z
,eeZ [
[ee\ ]
	FromQueryee] f
]eef g
inteeh k
?eek l

categoryIdeem w
)eew x
{ff 
vargg 
querygg 
=gg 
_dbgg 
.gg 
Articlesgg 
.hh 	
Includehh	 
(hh 
ahh 
=>hh 
ahh 
.hh 
Categoryhh  
)hh  !
.ii 	
Includeii	 
(ii 
aii 
=>ii 
aii 
.ii 
Authorii 
)ii 
.jj 	
Wherejj	 
(jj 
ajj 
=>jj 
ajj 
.jj 
Statusjj 
==jj 
ArticleStatusjj  -
.jj- .
Approvedjj. 6
)jj6 7
.kk 	
AsQueryablekk	 
(kk 
)kk 
;kk 
ifmm 
(mm 
!mm 	
stringmm	 
.mm 
IsNullOrWhiteSpacemm "
(mm" #
qmm# $
)mm$ %
)mm% &
querynn 
=nn 
querynn 
.nn 
Wherenn 
(nn 
ann 
=>nn  
ann! "
.nn" #
Namenn# '
.nn' (
Containsnn( 0
(nn0 1
qnn1 2
)nn2 3
||nn4 6
ann7 8
.nn8 9
Descriptionnn9 D
.nnD E
ContainsnnE M
(nnM N
qnnN O
)nnO P
)nnP Q
;nnQ R
ifpp 
(pp 

categoryIdpp 
.pp 
HasValuepp 
)pp 
queryqq 
=qq 
queryqq 
.qq 
Whereqq 
(qq 
aqq 
=>qq  
aqq! "
.qq" #

CategoryIdqq# -
==qq. 0

categoryIdqq1 ;
.qq; <
Valueqq< A
)qqA B
;qqB C
varss 
resultss 
=ss 
awaitss 
queryss 
.tt 	
OrderByDescendingtt	 
(tt 
att 
=>tt 
att  !
.tt! "
	CreatedAttt" +
)tt+ ,
.uu 	
Selectuu	 
(uu 
auu 
=>uu 
newuu 
ArticleResponseuu (
{vv 	
Idww 
=ww 
aww 
.ww 
Idww 
,ww 
Namexx 
=xx 
axx 
.xx 
Namexx 
,xx 
Descriptionyy 
=yy 
ayy 
.yy 
Descriptionyy '
,yy' (
Contentzz 
=zz 
azz 
.zz 
Contentzz 
,zz  

CategoryId{{ 
={{ 
a{{ 
.{{ 

CategoryId{{ %
,{{% &
CategoryName|| 
=|| 
a|| 
.|| 
Category|| %
.||% &
Name||& *
,||* +
AuthorId}} 
=}} 
a}} 
.}} 
AuthorId}} !
,}}! "

AuthorName~~ 
=~~ 
a~~ 
.~~ 
Author~~ !
.~~! "
Name~~" &
,~~& '
Status 
= 
a 
. 
Status 
. 
ToString &
(& '
)' (
,( )
RejectReason
ÄÄ 
=
ÄÄ 
a
ÄÄ 
.
ÄÄ 
RejectReason
ÄÄ )
,
ÄÄ) *

ApprovedAt
ÅÅ 
=
ÅÅ 
a
ÅÅ 
.
ÅÅ 

ApprovedAt
ÅÅ %
,
ÅÅ% &
	ViewCount
ÇÇ 
=
ÇÇ 
a
ÇÇ 
.
ÇÇ 
	ViewCount
ÇÇ #
,
ÇÇ# $
	CreatedAt
ÉÉ 
=
ÉÉ 
a
ÉÉ 
.
ÉÉ 
	CreatedAt
ÉÉ #
,
ÉÉ# $
}
ÑÑ 	
)
ÑÑ	 

.
ÖÖ 	
ToListAsync
ÖÖ	 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
return
áá 

Ok
áá 
(
áá 
result
áá 
)
áá 
;
áá 
}àà 
[
çç 
HttpGet
çç 
(
çç 
$str
çç 
)
çç 
]
çç 
public
éé 

async
éé 
Task
éé 
<
éé 
ActionResult
éé "
<
éé" #
object
éé# )
>
éé) *
>
éé* +
	Dashboard
éé, 5
(
éé5 6
)
éé6 7
{
èè 
var
êê 

totalUsers
êê 
=
êê 
await
êê 
_db
êê "
.
êê" #
Users
êê# (
.
êê( )

CountAsync
êê) 3
(
êê3 4
)
êê4 5
;
êê5 6
var
ëë 
contributors
ëë 
=
ëë 
await
ëë  
_db
ëë! $
.
ëë$ %
Users
ëë% *
.
ëë* +

CountAsync
ëë+ 5
(
ëë5 6
u
ëë6 7
=>
ëë8 :
u
ëë; <
.
ëë< =
Role
ëë= A
==
ëëB D
Role
ëëE I
.
ëëI J
Contributor
ëëJ U
)
ëëU V
;
ëëV W
var
íí 
pending
íí 
=
íí 
await
íí 
_db
íí 
.
íí  
Articles
íí  (
.
íí( )

CountAsync
íí) 3
(
íí3 4
a
íí4 5
=>
íí6 8
a
íí9 :
.
íí: ;
Status
íí; A
==
ííB D
ArticleStatus
ííE R
.
ííR S
Pending
ííS Z
)
ííZ [
;
íí[ \
var
ìì 
approved
ìì 
=
ìì 
await
ìì 
_db
ìì  
.
ìì  !
Articles
ìì! )
.
ìì) *

CountAsync
ìì* 4
(
ìì4 5
a
ìì5 6
=>
ìì7 9
a
ìì: ;
.
ìì; <
Status
ìì< B
==
ììC E
ArticleStatus
ììF S
.
ììS T
Approved
ììT \
)
ìì\ ]
;
ìì] ^
var
îî 
	topViewed
îî 
=
îî 
await
îî 
_db
îî !
.
îî! "
Articles
îî" *
.
îî* +
Where
îî+ 0
(
îî0 1
a
îî1 2
=>
îî3 5
a
îî6 7
.
îî7 8
Status
îî8 >
==
îî? A
ArticleStatus
îîB O
.
îîO P
Approved
îîP X
)
îîX Y
.
ïï 
OrderByDescending
ïï 
(
ïï 
a
ïï  
=>
ïï! #
a
ïï$ %
.
ïï% &
	ViewCount
ïï& /
)
ïï/ 0
.
ññ 
Take
ññ 
(
ññ 
$num
ññ 
)
ññ 
.
óó 
Select
óó 
(
óó 
a
óó 
=>
óó 
new
óó 
{
óó 
a
óó  
.
óó  !
Id
óó! #
,
óó# $
a
óó% &
.
óó& '
Name
óó' +
,
óó+ ,
a
óó- .
.
óó. /
	ViewCount
óó/ 8
}
óó9 :
)
óó: ;
.
òò 
ToListAsync
òò 
(
òò 
)
òò 
;
òò 
return
öö 
Ok
öö 
(
öö 
new
öö 
{
õõ 	

totalUsers
úú 
,
úú 
contributors
ùù 
,
ùù 
pendingApprovals
ûû 
=
ûû 
pending
ûû &
,
ûû& '
approvedDocuments
üü 
=
üü 
approved
üü  (
,
üü( )
	topViewed
†† 
}
°° 	
)
°°	 

;
°°
 
}
¢¢ 
[
•• 
	Authorize
•• 
(
•• 
Policy
•• 
=
•• 
$str
•• "
)
••" #
]
••# $
[
¶¶ 
HttpGet
¶¶ 
(
¶¶ 
$str
¶¶ 
)
¶¶ 
]
¶¶ 
public
ßß 

async
ßß 
Task
ßß 
<
ßß 
ActionResult
ßß "
<
ßß" #
IEnumerable
ßß# .
<
ßß. /
UserSummary
ßß/ :
>
ßß: ;
>
ßß; <
>
ßß< =
GetUsers
ßß> F
(
ßßF G
)
ßßG H
{
®® 
var
©© 
users
©© 
=
©© 
await
©© 
_db
©© 
.
©© 
Users
©© #
.
™™ 
OrderBy
™™ 
(
™™ 
u
™™ 
=>
™™ 
u
™™ 
.
™™ 
Name
™™  
)
™™  !
.
´´ 
Select
´´ 
(
´´ 
u
´´ 
=>
´´ 
new
´´ 
UserSummary
´´ (
{
¨¨ 
Id
≠≠ 
=
≠≠ 
u
≠≠ 
.
≠≠ 
Id
≠≠ 
,
≠≠ 

EmployeeId
ÆÆ 
=
ÆÆ 
u
ÆÆ 
.
ÆÆ 

EmployeeId
ÆÆ )
,
ÆÆ) *
Name
ØØ 
=
ØØ 
u
ØØ 
.
ØØ 
Name
ØØ 
,
ØØ 
Email
∞∞ 
=
∞∞ 
u
∞∞ 
.
∞∞ 
Email
∞∞ 
,
∞∞  
Role
±± 
=
±± 
u
±± 
.
±± 
Role
±± 
.
±± 
ToString
±± &
(
±±& '
)
±±' (
,
±±( )
IsActive
≤≤ 
=
≤≤ 
u
≤≤ 
.
≤≤ 
IsActive
≤≤ %
}
≥≥ 
)
≥≥ 
.
¥¥ 
ToListAsync
¥¥ 
(
¥¥ 
)
¥¥ 
;
¥¥ 
return
∂∂ 
Ok
∂∂ 
(
∂∂ 
users
∂∂ 
)
∂∂ 
;
∂∂ 
}
∑∑ 
[
∏∏ 
	Authorize
∏∏ 
(
∏∏ 
Policy
∏∏ 
=
∏∏ 
$str
∏∏ #
)
∏∏# $
]
∏∏$ %
[
ππ 
HttpGet
ππ 
(
ππ 
$str
ππ 
)
ππ 
]
ππ 
public
∫∫ 

async
∫∫ 
Task
∫∫ 
<
∫∫ 
ActionResult
∫∫ "
<
∫∫" #
UserSummary
∫∫# .
>
∫∫. /
>
∫∫/ 0
GetUser
∫∫1 8
(
∫∫8 9
int
∫∫9 <
id
∫∫= ?
)
∫∫? @
{
ªª 
var
ºº 
u
ºº 
=
ºº 
await
ºº 
_db
ºº 
.
ºº 
Users
ºº 
.
ºº  
	FindAsync
ºº  )
(
ºº) *
id
ºº* ,
)
ºº, -
;
ºº- .
if
ΩΩ 

(
ΩΩ 
u
ΩΩ 
==
ΩΩ 
null
ΩΩ 
)
ΩΩ 
return
ΩΩ 
NotFound
ΩΩ &
(
ΩΩ& '
)
ΩΩ' (
;
ΩΩ( )
return
øø 
Ok
øø 
(
øø 
new
øø 
UserSummary
øø !
{
¿¿ 	
Id
¡¡ 
=
¡¡ 
u
¡¡ 
.
¡¡ 
Id
¡¡ 
,
¡¡ 

EmployeeId
¬¬ 
=
¬¬ 
u
¬¬ 
.
¬¬ 

EmployeeId
¬¬ %
,
¬¬% &
Name
√√ 
=
√√ 
u
√√ 
.
√√ 
Name
√√ 
,
√√ 
Email
ƒƒ 
=
ƒƒ 
u
ƒƒ 
.
ƒƒ 
Email
ƒƒ 
,
ƒƒ 
Role
≈≈ 
=
≈≈ 
u
≈≈ 
.
≈≈ 
Role
≈≈ 
.
≈≈ 
ToString
≈≈ "
(
≈≈" #
)
≈≈# $
,
≈≈$ %
IsActive
∆∆ 
=
∆∆ 
u
∆∆ 
.
∆∆ 
IsActive
∆∆ !
}
«« 	
)
««	 

;
««
 
}
»» 
[
…… 
	Authorize
…… 
(
…… 
Policy
…… 
=
…… 
$str
…… #
)
……# $
]
……$ %
[
   
HttpPost
   
(
   
$str
   
)
   
]
   
public
ÀÀ 

async
ÀÀ 
Task
ÀÀ 
<
ÀÀ 
ActionResult
ÀÀ "
<
ÀÀ" #
UserSummary
ÀÀ# .
>
ÀÀ. /
>
ÀÀ/ 0

CreateUser
ÀÀ1 ;
(
ÀÀ; <
[
ÀÀ< =
FromBody
ÀÀ= E
]
ÀÀE F
CreateUserRequest
ÀÀG X
req
ÀÀY \
)
ÀÀ\ ]
{
ÃÃ 
if
ÕÕ 

(
ÕÕ 
req
ÕÕ 
.
ÕÕ 
Role
ÕÕ 
==
ÕÕ 
Role
ÕÕ 
.
ÕÕ 
Admin
ÕÕ "
)
ÕÕ" #
return
ÕÕ$ *

BadRequest
ÕÕ+ 5
(
ÕÕ5 6
$str
ÕÕ6 T
)
ÕÕT U
;
ÕÕU V
if
ŒŒ 

(
ŒŒ 
await
ŒŒ 
_db
ŒŒ 
.
ŒŒ 
Users
ŒŒ 
.
ŒŒ 
AnyAsync
ŒŒ $
(
ŒŒ$ %
x
ŒŒ% &
=>
ŒŒ' )
x
ŒŒ* +
.
ŒŒ+ ,
Email
ŒŒ, 1
==
ŒŒ2 4
req
ŒŒ5 8
.
ŒŒ8 9
Email
ŒŒ9 >
)
ŒŒ> ?
)
ŒŒ? @
return
œœ 
Conflict
œœ 
(
œœ 
$str
œœ 3
)
œœ3 4
;
œœ4 5
var
—— 
user
—— 
=
—— 
new
—— 
User
—— 
{
““ 	

EmployeeId
”” 
=
”” 
req
”” 
.
”” 

EmployeeId
”” '
,
””' (
Name
‘‘ 
=
‘‘ 
req
‘‘ 
.
‘‘ 
Name
‘‘ 
,
‘‘ 
Email
’’ 
=
’’ 
req
’’ 
.
’’ 
Email
’’ 
,
’’ 
PasswordHash
÷÷ 
=
÷÷ 
new
÷÷ 
PasswordHasher
÷÷ -
(
÷÷- .
)
÷÷. /
.
÷÷/ 0
Hash
÷÷0 4
(
÷÷4 5
req
÷÷5 8
.
÷÷8 9
Password
÷÷9 A
)
÷÷A B
,
÷÷B C
Role
◊◊ 
=
◊◊ 
req
◊◊ 
.
◊◊ 
Role
◊◊ 
,
◊◊ 
IsActive
ÿÿ 
=
ÿÿ 
true
ÿÿ 
}
ŸŸ 	
;
ŸŸ	 

_db
€€ 
.
€€ 
Users
€€ 
.
€€ 
Add
€€ 
(
€€ 
user
€€ 
)
€€ 
;
€€ 
await
‹‹ 
_db
‹‹ 
.
‹‹ 
SaveChangesAsync
‹‹ "
(
‹‹" #
)
‹‹# $
;
‹‹$ %
return
ﬁﬁ 
Ok
ﬁﬁ 
(
ﬁﬁ 
new
ﬁﬁ 
UserSummary
ﬁﬁ !
{
ﬂﬂ 	
Id
‡‡ 
=
‡‡ 
user
‡‡ 
.
‡‡ 
Id
‡‡ 
,
‡‡ 

EmployeeId
·· 
=
·· 
user
·· 
.
·· 

EmployeeId
·· (
,
··( )
Name
‚‚ 
=
‚‚ 
user
‚‚ 
.
‚‚ 
Name
‚‚ 
,
‚‚ 
Email
„„ 
=
„„ 
user
„„ 
.
„„ 
Email
„„ 
,
„„ 
Role
‰‰ 
=
‰‰ 
user
‰‰ 
.
‰‰ 
Role
‰‰ 
.
‰‰ 
ToString
‰‰ %
(
‰‰% &
)
‰‰& '
,
‰‰' (
IsActive
ÂÂ 
=
ÂÂ 
user
ÂÂ 
.
ÂÂ 
IsActive
ÂÂ $
}
ÊÊ 	
)
ÊÊ	 

;
ÊÊ
 
}
ÁÁ 
[
ËË 
	Authorize
ËË 
(
ËË 
Policy
ËË 
=
ËË 
$str
ËË #
)
ËË# $
]
ËË$ %
[
ÈÈ 
HttpPut
ÈÈ 
(
ÈÈ 
$str
ÈÈ 
)
ÈÈ 
]
ÈÈ 
public
ÍÍ 

async
ÍÍ 
Task
ÍÍ 
<
ÍÍ 
IActionResult
ÍÍ #
>
ÍÍ# $

UpdateUser
ÍÍ% /
(
ÍÍ/ 0
int
ÍÍ0 3
id
ÍÍ4 6
,
ÍÍ6 7
[
ÍÍ8 9
FromBody
ÍÍ9 A
]
ÍÍA B
UpdateUserRequest
ÍÍC T
req
ÍÍU X
)
ÍÍX Y
{
ÎÎ 
var
ÏÏ 
user
ÏÏ 
=
ÏÏ 
await
ÏÏ 
_db
ÏÏ 
.
ÏÏ 
Users
ÏÏ "
.
ÏÏ" #
	FindAsync
ÏÏ# ,
(
ÏÏ, -
id
ÏÏ- /
)
ÏÏ/ 0
;
ÏÏ0 1
if
ÌÌ 

(
ÌÌ 
user
ÌÌ 
==
ÌÌ 
null
ÌÌ 
)
ÌÌ 
return
ÌÌ  
NotFound
ÌÌ! )
(
ÌÌ) *
)
ÌÌ* +
;
ÌÌ+ ,
if
 

(
 
req
 
.
 
Role
 
==
 
Role
 
.
 
Admin
 "
)
" #
return
ÒÒ 

BadRequest
ÒÒ 
(
ÒÒ 
$str
ÒÒ A
)
ÒÒA B
;
ÒÒB C
if
ÛÛ 

(
ÛÛ 
user
ÛÛ 
.
ÛÛ 
Email
ÛÛ 
!=
ÛÛ 
req
ÛÛ 
.
ÛÛ 
Email
ÛÛ #
&&
ÛÛ$ &
await
ÛÛ' ,
_db
ÛÛ- 0
.
ÛÛ0 1
Users
ÛÛ1 6
.
ÛÛ6 7
AnyAsync
ÛÛ7 ?
(
ÛÛ? @
u
ÛÛ@ A
=>
ÛÛB D
u
ÛÛE F
.
ÛÛF G
Email
ÛÛG L
==
ÛÛM O
req
ÛÛP S
.
ÛÛS T
Email
ÛÛT Y
)
ÛÛY Z
)
ÛÛZ [
return
ÙÙ 
Conflict
ÙÙ 
(
ÙÙ 
$str
ÙÙ 3
)
ÙÙ3 4
;
ÙÙ4 5
user
ˆˆ 
.
ˆˆ 

EmployeeId
ˆˆ 
=
ˆˆ 
req
ˆˆ 
.
ˆˆ 

EmployeeId
ˆˆ (
;
ˆˆ( )
user
˜˜ 
.
˜˜ 
Name
˜˜ 
=
˜˜ 
req
˜˜ 
.
˜˜ 
Name
˜˜ 
;
˜˜ 
user
¯¯ 
.
¯¯ 
Email
¯¯ 
=
¯¯ 
req
¯¯ 
.
¯¯ 
Email
¯¯ 
;
¯¯ 
user
˘˘ 
.
˘˘ 
Role
˘˘ 
=
˘˘ 
req
˘˘ 
.
˘˘ 
Role
˘˘ 
;
˘˘ 
if
˚˚ 

(
˚˚ 
!
˚˚ 
string
˚˚ 
.
˚˚  
IsNullOrWhiteSpace
˚˚ &
(
˚˚& '
req
˚˚' *
.
˚˚* +
Password
˚˚+ 3
)
˚˚3 4
)
˚˚4 5
{
¸¸ 	
user
˝˝ 
.
˝˝ 
PasswordHash
˝˝ 
=
˝˝ 
new
˝˝  #
PasswordHasher
˝˝$ 2
(
˝˝2 3
)
˝˝3 4
.
˝˝4 5
Hash
˝˝5 9
(
˝˝9 :
req
˝˝: =
.
˝˝= >
Password
˝˝> F
)
˝˝F G
;
˝˝G H
}
˛˛ 	
user
ˇˇ 
.
ˇˇ 
IsActive
ˇˇ 
=
ˇˇ 
req
ˇˇ 
.
ˇˇ 
IsActive
ˇˇ $
;
ˇˇ$ %
await
ÄÄ 
_db
ÄÄ 
.
ÄÄ 
SaveChangesAsync
ÄÄ "
(
ÄÄ" #
)
ÄÄ# $
;
ÄÄ$ %
return
ÇÇ 
	NoContent
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÉÉ 
[
ÑÑ 
	Authorize
ÑÑ 
(
ÑÑ 
Policy
ÑÑ 
=
ÑÑ 
$str
ÑÑ #
)
ÑÑ# $
]
ÑÑ$ %
[
ÖÖ 

HttpDelete
ÖÖ 
(
ÖÖ 
$str
ÖÖ  
)
ÖÖ  !
]
ÖÖ! "
public
ÜÜ 

async
ÜÜ 
Task
ÜÜ 
<
ÜÜ 
IActionResult
ÜÜ #
>
ÜÜ# $

DeleteUser
ÜÜ% /
(
ÜÜ/ 0
int
ÜÜ0 3
id
ÜÜ4 6
)
ÜÜ6 7
{
áá 
var
àà 
user
àà 
=
àà 
await
àà 
_db
àà 
.
àà 
Users
àà "
.
àà" #
	FindAsync
àà# ,
(
àà, -
id
àà- /
)
àà/ 0
;
àà0 1
if
ââ 

(
ââ 
user
ââ 
==
ââ 
null
ââ 
)
ââ 
return
ââ  
NotFound
ââ! )
(
ââ) *
)
ââ* +
;
ââ+ ,
_db
ãã 
.
ãã 
Users
ãã 
.
ãã 
Remove
ãã 
(
ãã 
user
ãã 
)
ãã 
;
ãã 
await
åå 
_db
åå 
.
åå 
SaveChangesAsync
åå "
(
åå" #
)
åå# $
;
åå$ %
return
çç 
	NoContent
çç 
(
çç 
)
çç 
;
çç 
}
éé 
}èè å
5D:\backendkb\KnowledgeBase.Api\Auth\PasswordHasher.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
Auth  
;  !
public 
class 
PasswordHasher 
{ 
public 

string 
Hash 
( 
string 
password &
)& '
=>( *
BCrypt+ 1
.1 2
Net2 5
.5 6
BCrypt6 <
.< =
HashPassword= I
(I J
passwordJ R
)R S
;S T
public 

bool 
Verify 
( 
string 
password &
,& '
string( .
hash/ 3
)3 4
=>5 7
BCrypt8 >
.> ?
Net? B
.B C
BCryptC I
.I J
VerifyJ P
(P Q
passwordQ Y
,Y Z
hash[ _
)_ `
;` a
}		 ·
6D:\backendkb\KnowledgeBase.Api\Auth\JwtTokenService.cs
	namespace 	
KnowledgeBase
 
. 
Api 
. 
Auth  
;  !
public

 
class

 
JwtTokenService

 
{ 
private 
readonly 
IConfiguration #
_config$ +
;+ ,
public 

JwtTokenService 
( 
IConfiguration )
config* 0
)0 1
=>2 4
_config5 <
== >
config? E
;E F
public 

string 
Create 
( 
User 
u 
)  
{ 
var 
claims 
= 
new 
List 
< 
Claim #
># $
{ 	
new 
Claim 
( #
JwtRegisteredClaimNames -
.- .
Sub. 1
,1 2
u3 4
.4 5
Id5 7
.7 8
ToString8 @
(@ A
)A B
)B C
,C D
new 
Claim 
( 

ClaimTypes  
.  !
NameIdentifier! /
,/ 0
u1 2
.2 3
Id3 5
.5 6
ToString6 >
(> ?
)? @
)@ A
,A B
new 
Claim 
( 

ClaimTypes  
.  !
Name! %
,% &
u' (
.( )
Name) -
)- .
,. /
new 
Claim 
( 

ClaimTypes  
.  !
Email! &
,& '
u( )
.) *
Email* /
)/ 0
,0 1
new 
Claim 
( 

ClaimTypes  
.  !
Role! %
,% &
u' (
.( )
Role) -
.- .
ToString. 6
(6 7
)7 8
)8 9
} 	
;	 

var 
key 
= 
new  
SymmetricSecurityKey *
(* +
Encoding+ 3
.3 4
UTF84 8
.8 9
GetBytes9 A
(A B
_configB I
[I J
$strJ S
]S T
!T U
)U V
)V W
;W X
var 
creds 
= 
new 
SigningCredentials *
(* +
key+ .
,. /
SecurityAlgorithms0 B
.B C

HmacSha256C M
)M N
;N O
var 
token 
= 
new 
JwtSecurityToken (
(( )
issuer 
: 
_config 
[ 
$str (
]( )
,) *
audience 
: 
_config 
[ 
$str ,
], -
,- .
claims   
:   
claims   
,   
expires!! 
:!! 
DateTime!! 
.!! 
UtcNow!! $
.!!$ %

AddMinutes!!% /
(!!/ 0
int!!0 3
.!!3 4
Parse!!4 9
(!!9 :
_config!!: A
[!!A B
$str!!B V
]!!V W
!!!W X
)!!X Y
)!!Y Z
,!!Z [
signingCredentials"" 
:"" 
creds""  %
)## 	
;##	 

return%% 
new%% #
JwtSecurityTokenHandler%% *
(%%* +
)%%+ ,
.%%, -

WriteToken%%- 7
(%%7 8
token%%8 =
)%%= >
;%%> ?
}&& 
}'' 